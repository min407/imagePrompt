<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŒè¡Œè°ƒç ”å·¥å…·</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/datatables.net-bs5@1.11.5/css/dataTables.bootstrap5.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        .main-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
        }
        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            margin-bottom: 1.5rem;
        }
        .card-header {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border-radius: 15px 15px 0 0 !important;
            border: none;
            font-weight: 600;
        }
        .platform-chip {
            display: inline-block;
            padding: 0.5rem 1rem;
            margin: 0.25rem;
            border-radius: 25px;
            background: #e9ecef;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .platform-category {
            padding: 0.3rem;
            border-radius: 6px;
            background: #f8f9fa;
            border: 1px solid #e9ecef;
        }
        
        .custom-platform-chip {
            display: inline-block;
            padding: 0.3rem 0.6rem;
            margin: 0.15rem;
            border-radius: 16px;
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            font-size: 0.8rem;
            cursor: pointer;
            position: relative;
        }
        
        .custom-platform-chip .remove-btn {
            margin-left: 0.3rem;
            cursor: pointer;
            opacity: 0.7;
        }
        
        .custom-platform-chip .remove-btn:hover {
            opacity: 1;
        }
        
        /* è°ƒæ•´å¹³å°èŠ¯ç‰‡å¤§å° */
        .platform-chip {
            display: inline-block;
            padding: 0.3rem 0.6rem;
            margin: 0.15rem;
            border-radius: 20px;
            background: #e9ecef;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            font-size: 0.8rem;
        }
        
        /* è°ƒæ•´åˆ†ç±»æ ‡é¢˜å¤§å° */
        .platform-category small {
            font-size: 0.75rem;
        }
        
        /* è°ƒæ•´ä¸‹æ‹‰æ¡†å­—ä½“å¤§å° */
        #research_platforms {
            font-size: 0.85rem;
            min-height: 200px;
        }
        
        #research_platforms option {
            font-size: 0.8rem;
            padding: 0.3rem 0.5rem;
        }
        
        #research_platforms optgroup {
            font-weight: bold;
            font-size: 0.85rem;
        }
        .platform-chip.selected {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #5a67d8;
        }
        .path-step {
            display: inline-block;
            padding: 0.5rem 1rem;
            margin: 0.25rem;
            border-radius: 20px;
            background: #e3f2fd;
            color: #1976d2;
            font-size: 0.9rem;
        }
        .path-arrow {
            margin: 0 0.5rem;
            color: #666;
        }
        .form-label {
            font-weight: 600;
            color: #495057;
            margin-bottom: 0.5rem;
        }
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 25px;
            padding: 0.75rem 2rem;
            font-weight: 600;
        }
        .btn-success {
            background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%);
            border: none;
            border-radius: 25px;
            padding: 0.75rem 2rem;
            font-weight: 600;
        }
        .analysis-card {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }
        .score-circle {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            color: white;
            margin: 0 auto 1rem;
        }
        .navbar {
            background: white !important;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .nav-link {
            color: #495057 !important;
            font-weight: 500;
            margin: 0 0.5rem;
            border-radius: 25px;
            padding: 0.5rem 1rem !important;
            transition: all 0.3s ease;
        }
        .nav-link:hover, .nav-link.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white !important;
        }
        .export-btn {
            margin: 0.25rem;
            border-radius: 20px;
        }
        .filter-section {
            background: white;
            padding: 1.5rem;
            border-radius: 15px;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .stats-card {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            text-align: center;
            margin-bottom: 1rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .stats-number {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
        }
        .tag {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            margin: 0.25rem;
            border-radius: 15px;
            background: #e9ecef;
            color: #495057;
            font-size: 0.8rem;
        }
        .tag.traffic { background: #e3f2fd; color: #1976d2; }
        .tag.product { background: #f3e5f5; color: #7b1fa2; }
        .tag.operation { background: #e8f5e8; color: #388e3c; }
          
        /* ä¼˜åŒ–æµé‡å½¢å¼å’Œäº¤ä»˜å½¢å¼çš„å¸ƒå±€ */
        .form-section .row .col-md-6 .form-check {
            margin-bottom: 0.75rem;
            padding: 0;
            background: transparent;
            border-radius: 0;
            border: none;
            transition: none;
            display: flex;
            align-items: center;
            min-height: auto;
        }
        .form-section .row .col-md-6 .form-check:hover {
            background: transparent;
            border: none;
        }
        .form-section .row .col-md-6 .form-check-input {
            margin-right: 0.75rem;
            flex-shrink: 0;
            width: 18px;
            height: 18px;
        }
        .form-section .row .col-md-6 .form-check-label {
            margin: 0;
            line-height: 1.4;
            flex-grow: 1;
            word-wrap: break-word;
            font-size: 15px;
            color: #495057;
        }
        .form-section .row .col-md-6 .form-check-input:checked + .form-check-label {
            font-weight: 600;
            color: #667eea;
        }
        .form-section .row .col-md-6 .form-check-input:checked ~ .form-check {
            background: transparent;
            border: none;
        }
        
        /* ç§»é™¤é»˜è®¤çš„form-checké—´è· */
        .form-section .form-check {
            margin-bottom: 0;
        }
        
        .modal-content {
            border-radius: 15px;
            border: none;
        }
        .modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px 15px 0 0;
        }
        .progress {
            height: 10px;
            border-radius: 5px;
        }
        .step-indicator {
            display: flex;
            justify-content: space-between;
            margin-bottom: 2rem;
        }
        .step {
            flex: 1;
            text-align: center;
            position: relative;
        }
        .step::after {
            content: '';
            position: absolute;
            top: 15px;
            left: 50%;
            width: 100%;
            height: 2px;
            background: #e9ecef;
            z-index: -1;
        }
        .step:last-child::after {
            display: none;
        }
        .step.active::after {
            background: #667eea;
        }
        .step-circle {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #e9ecef;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 0.5rem;
            font-weight: bold;
            font-size: 0.8rem;
        }
        .step.active .step-circle {
            background: #667eea;
            color: white;
        }
        .form-section {
            display: none;
        }
        .form-section.active {
            display: block;
        }
        
        /* ç»Ÿä¸€è¡¨å•æ§ä»¶æ ·å¼ */
        .form-control, .form-select {
            border: 1px solid #dee2e6;
            border-radius: 6px;
            font-size: 14px;
            padding: 0.5rem 0.75rem;
            transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
        }
        .form-control:focus, .form-select:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
        }
        
        /* ç»Ÿä¸€è¡¨å•é—´è· */
        .mb-3 {
            margin-bottom: 1.5rem !important;
        }
        
        /* ä¼˜åŒ–å¡ç‰‡æ ·å¼ */
        .card {
            border: 1px solid #dee2e6;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            transition: box-shadow 0.2s ease;
        }
        .card:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .card-body {
            padding: 1.25rem;
        }
        .card-title {
            font-size: 14px;
            font-weight: 600;
            color: #495057;
            margin-bottom: 0.75rem;
        }
        
        /* ç« èŠ‚æ ‡é¢˜æ ·å¼ */
        .section-header {
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #e9ecef;
        }
        .section-title {
            font-size: 16px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 0.5rem;
        }
        .section-subtitle {
            font-size: 12px;
            color: #6c757d;
            margin: 0;
            font-weight: 400;
        }
        
        /* ç»Ÿä¸€æ‰€æœ‰è¡¨å•æ ‡ç­¾ä¸ºåŠ ç²— */
        .form-label {
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 0.75rem;
            font-size: 16px;
        }
        
        /* äºŒçº§æ ‡é¢˜æ ·å¼ - å¢å¤§å­—ä½“å¹¶æ·»åŠ åºå·æ ·å¼ */
        .form-label.section-subtitle {
            font-size: 18px;
            font-weight: 700;
            color: #1a365d;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
        }
        
        .form-label.section-subtitle::before {
            content: attr(data-number);
            background: #667eea;
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            margin-right: 0.75rem;
            flex-shrink: 0;
        }
        
        /* è¯´æ˜æ–‡å­—æœ€å°å­—å· */
        .text-muted {
            font-size: 12px;
            color: #6c757d;
        }
        
        .form-text {
            font-size: 12px;
            color: #6c757d;
        }
        
        /* å¡ç‰‡æ ‡é¢˜åŠ ç²— */
        .card-title {
            font-size: 16px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 0.75rem;
        }
        
        /* æ‰‹æœºç«¯ä¼˜åŒ– */
        @media (max-width: 768px) {
            /* æ•´ä½“å¸ƒå±€ä¼˜åŒ– */
            .container-fluid {
                padding: 1rem;
            }
            
            /* æ ‡é¢˜å“åº”å¼ - ä¿æŒä¸æ­¥éª¤æŒ‡ç¤ºå™¨ä¸€è‡´ */
            .section-title {
                font-size: 16px;
            }
            
            .form-label {
                font-size: 16px;
            }
            
            .card-title {
                font-size: 16px;
            }
            
            /* è¡¨å•æ§ä»¶ä¼˜åŒ– */
            .form-control, .form-select {
                font-size: 16px; /* é˜²æ­¢iOSç¼©æ”¾ */
                padding: 0.75rem;
            }
            
            /* å¤šé€‰ä¸‹æ‹‰æ¡†ç§»åŠ¨ç«¯ä¼˜åŒ– */
            select[multiple] {
                font-size: 16px; /* æ‰‹æœºç«¯æ›´å¤§å­—ä½“ */
            }
            
            /* å¤é€‰æ¡†å¢å¤§ç‚¹å‡»åŒºåŸŸ */
            .form-check-input {
                width: 20px;
                height: 20px;
                margin-right: 0.75rem;
            }
            
            .product-type-selector .form-check-label,
            .monetization-selector .form-check-label,
            .form-section .row .col-md-6 .form-check-label {
                font-size: 16px; /* æ‰‹æœºç«¯æ›´å¤§å­—ä½“ */
                line-height: 1.5;
                padding-top: 2px;
            }
            
            /* å¡ç‰‡ä¼˜åŒ– */
            .card {
                margin-bottom: 1rem;
            }
            
            .card-body {
                padding: 1rem;
            }
            
            /* æŒ‰é’®ä¼˜åŒ– */
            .btn {
                font-size: 16px;
                padding: 0.75rem 1rem;
                touch-action: manipulation; /* ä¼˜åŒ–è§¦æ‘¸ */
            }
            
            /* æ­¥éª¤æŒ‡ç¤ºå™¨ä¼˜åŒ– */
            .step-indicator {
                flex-direction: column;
                gap: 1rem;
            }
            
            .step {
                text-align: center;
            }
            
            .step::after {
                display: none; /* éšè—è¿æ¥çº¿ */
            }
            
            /* å¹³å°é€‰æ‹©å™¨ä¼˜åŒ– */
            .platform-selector {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 0.5rem;
            }
            
            .platform-chip {
                padding: 0.75rem 0.5rem;
                font-size: 14px;
                text-align: center;
            }
            
            /* å¯¼èˆªæ ä¼˜åŒ– */
            .navbar {
                padding: 0.5rem 1rem;
            }
            
            .nav-link {
                font-size: 14px;
                padding: 0.5rem 0.75rem;
                margin: 0.25rem;
            }
            
            /* æ¨¡æ€æ¡†ä¼˜åŒ– */
            .modal-dialog {
                margin: 1rem;
            }
            
            .modal-content {
                border-radius: 10px;
            }
            
            /* è¡¨æ ¼ä¼˜åŒ– */
            .table-responsive {
                font-size: 14px;
            }
            
            .btn-sm {
                padding: 0.5rem 0.75rem;
                font-size: 14px;
            }
        }
        
        /* è¶…å°å±å¹•è¿›ä¸€æ­¥ä¼˜åŒ– */
        @media (max-width: 480px) {
            .container-fluid {
                padding: 0.5rem;
            }
            
            .section-header {
                margin-bottom: 1.5rem;
                padding-bottom: 0.75rem;
            }
            
            .product-type-selector,
            .monetization-selector {
                padding: 0.75rem;
                gap: 0.5rem;
            }
            
            .platform-selector {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar navbar-expand-lg navbar-light">
        <div class="container">
            <a class="navbar-brand fw-bold text-primary" href="#">åŒè¡Œè°ƒç ”å·¥å…·</a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link active" href="#" data-tab="form">æ·»åŠ è°ƒç ”</a>
                <a class="nav-link" href="#" data-tab="list">è°ƒç ”åˆ—è¡¨</a>
                <a class="nav-link" href="#" data-tab="analysis">æ±‡æ€»åˆ†æ</a>
            </div>
        </div>
    </nav>

    <!-- ä¸»è¦å†…å®¹ -->
    <div class="container">
        <!-- è¡¨å•é¡µé¢ -->
        <div id="form-page" class="tab-content">
            <div class="row">
                <div class="col-lg-8 mx-auto">
                    <div class="card">
                        <div class="card-header">
                            <h4 class="mb-0">æ·»åŠ åŒè¡Œè°ƒç ”</h4>
                        </div>
                        <div class="card-body">
                            <form id="research-form">
                                <!-- æ­¥éª¤æŒ‡ç¤ºå™¨ -->
                                <div class="step-indicator">
                                    <div class="step active" data-step="1">
                                        <div class="step-circle">1</div>
                                        <div>åŸºç¡€ä¿¡æ¯</div>
                                    </div>
                                    <div class="step" data-step="2">
                                        <div class="step-circle">2</div>
                                        <div>æµé‡åˆ†æ</div>
                                    </div>
                                    <div class="step" data-step="3">
                                        <div class="step-circle">3</div>
                                        <div>äº§å“åˆ†æ</div>
                                    </div>
                                    <div class="step" data-step="4">
                                        <div class="step-circle">4</div>
                                        <div>è¿è¥åˆ†æ</div>
                                    </div>
                                </div>

                                <!-- ç¬¬ä¸€æ­¥ï¼šåŸºç¡€ä¿¡æ¯ -->
                                <div class="form-section active" data-section="1">
                                    <div class="section-header">
                                        <h4 class="section-title">Â· åŸºç¡€ä¿¡æ¯</h4>
                                        <p class="section-subtitle">è®°å½•åŒè¡Œçš„åŸºæœ¬æƒ…å†µå’Œç‰¹å¾</p>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label">è°ƒç ”æ—¥æœŸ</label>
                                                <input type="date" class="form-control" id="research_date" required>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label">åŒè¡Œæ˜µç§°/è´¦å·</label>
                                                <input type="text" class="form-control" id="peer_name" placeholder="ç»™è¿™ä¸ªåŒè¡Œèµ·ä¸ªåå­—">
                                            </div>
                                        </div>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label section-subtitle" data-number="1">åŒè¡ŒåŸºæœ¬ä¿¡æ¯</label>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label section-subtitle" data-number="2">è°ƒç ”å¹³å° <span class="text-muted">(å¯å¤šé€‰)</span></label>
                                        <select class="form-select" id="research_platforms" multiple="multiple" size="8">
                                            <optgroup label="ğŸ“± ä¸»è¦å†…å®¹å¹³å°">
                                                <option value="å°çº¢ä¹¦">ğŸ“± å°çº¢ä¹¦</option>
                                                <option value="æŠ–éŸ³">ğŸµ æŠ–éŸ³</option>
                                                <option value="çŸ¥ä¹">ğŸ“š çŸ¥ä¹</option>
                                                <option value="Bç«™">ğŸ“º Bç«™</option>
                                                <option value="å¾®åš">ğŸ”„ å¾®åš</option>
                                                <option value="å¿«æ‰‹">âš¡ å¿«æ‰‹</option>
                                            </optgroup>
                                            <optgroup label="ğŸ’¬ ç§åŸŸå¹³å°">
                                                <option value="å¾®ä¿¡">ğŸ’¬ å¾®ä¿¡</option>
                                                <option value="å…¬ä¼—å·">ğŸ“– å…¬ä¼—å·</option>
                                                <option value="è§†é¢‘å·">ğŸ“¹ è§†é¢‘å·</option>
                                                <option value="ä¼ä¸šå¾®ä¿¡">ğŸ¢ ä¼ä¸šå¾®ä¿¡</option>
                                            </optgroup>
                                            <optgroup label="ğŸ‘¥ ç¤¾ç¾¤å¹³å°">
                                                <option value="æ´»åŠ¨è¡Œ">ğŸ« æ´»åŠ›è¡Œ</option>
                                                <option value="å–ä¼™">ğŸ¤ å–ä¼™</option>
                                                <option value="çŸ¥è¯†æ˜Ÿçƒ">ğŸŒŸ çŸ¥è¯†æ˜Ÿçƒ</option>
                                                <option value="å°æ‰“å¡">ğŸ“… å°æ‰“å¡</option>
                                                <option value="å°å®‡å®™">ğŸ§ å°å®‡å®™</option>
                                                <option value="å³åˆ»">âš¡ å³åˆ»</option>
                                            </optgroup>
                                            <optgroup label="ğŸ›’ ç”µå•†å¹³å°">
                                                <option value="æ·˜å®">ğŸ›’ æ·˜å®</option>
                                                <option value="é—²é±¼">ğŸŸ é—²é±¼</option>
                                                <option value="äº¬ä¸œ">ğŸ›ï¸ äº¬ä¸œ</option>
                                                <option value="æ‹¼å¤šå¤š">ğŸ”¥ æ‹¼å¤šå¤š</option>
                                            </optgroup>
                                        </select>
                                        <div class="form-text text-muted">
                                            ğŸ’¡ æŒ‰ä½ Ctrl/Cmd é”®å¯å¤šé€‰ï¼Œæˆ–ç›´æ¥ç‚¹å‡»é€‰æ‹©
                                        </div>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label section-subtitle" data-number="3">ä¸€å¥è¯æè¿°è¿™ä¸ªåŒè¡Œ</label>
                                        <textarea class="form-control" id="peer_description" rows="2" placeholder="è¿™ä¸ªåŒè¡Œæ˜¯åšä»€ä¹ˆçš„ï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ"></textarea>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label section-subtitle" data-number="4">ä¸»è¦å®¢æˆ·ç¾¤ç±»å‹</label>
                                        <select class="form-select" id="customer_type">
                                            <option value="">è¯·é€‰æ‹©</option>
                                            <option value="To C">ğŸ‘¤ To C (é¢å‘ä¸ªäººæ¶ˆè´¹è€…)</option>
                                            <option value="To B">ğŸ¢ To B (é¢å‘ä¼ä¸šå®¢æˆ·)</option>
                                            <option value="ä¸¤è€…éƒ½æœ‰">ğŸ‘¥ ä¸¤è€…éƒ½æœ‰</option>
                                            <option value="çœ‹ä¸å‡ºæ¥">â“ çœ‹ä¸å‡ºæ¥</option>
                                        </select>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label section-subtitle" data-number="5">è¿è¥ä¸»ä½“</label>
                                        <select class="form-select" id="operation_entity">
                                            <option value="">è¯·é€‰æ‹©</option>
                                            <option value="ä¸ªäºº">ğŸ‘¤ ä¸ªäººè¿è¥</option>
                                            <option value="å°å›¢é˜Ÿ">ğŸ‘¥ å°å›¢é˜Ÿ (2-5äºº)</option>
                                            <option value="ä¸­å‹å›¢é˜Ÿ">ğŸ¢ ä¸­å‹å›¢é˜Ÿ (6-20äºº)</option>
                                            <option value="å¤§å›¢é˜Ÿ">ğŸ¢ å¤§å›¢é˜Ÿ (20äººä»¥ä¸Š)</option>
                                            <option value="å…¬å¸">ğŸ¢ å…¬å¸åŒ–è¿è¥</option>
                                            <option value="çœ‹ä¸å‡ºæ¥">â“ çœ‹ä¸å‡ºæ¥</option>
                                        </select>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label section-subtitle" data-number="6">æœ€åˆæ˜¯æ€ä¹ˆå¸å¼•åˆ°ä½ çš„ï¼Ÿ</label>
                                        <textarea class="form-control" id="attraction_point" rows="2" placeholder="ç”¨äº†ä»€ä¹ˆå¼•æµäº§å“ï¼Ÿè¯´äº†ä»€ä¹ˆè¯æœ¯ï¼Ÿ"></textarea>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label section-subtitle" data-number="7">æ‰€åŠ çš„è”ç³»æ–¹å¼</label>
                                                <select class="form-select" id="contact_method">
                                                    <option value="">è¯·é€‰æ‹©</option>
                                                    <option value="å¾®ä¿¡">ğŸ’¬ å¾®ä¿¡</option>
                                                    <option value="QQ">ğŸ§ QQ</option>
                                                    <option value="æ‰‹æœºå·">ğŸ“± æ‰‹æœºå·</option>
                                                    <option value="é—²é±¼">ğŸŸ é—²é±¼</option>
                                                    <option value="æ·˜å®">ğŸ›’ æ·˜å®</option>
                                                    <option value="å°çº¢ä¹¦">ğŸ“± å°çº¢ä¹¦</option>
                                                    <option value="æŠ–éŸ³">ğŸµ æŠ–éŸ³</option>
                                                    <option value="çŸ¥ä¹">ğŸ“š çŸ¥ä¹</option>
                                                    <option value="å…¶ä»–">ğŸ“Œ å…¶ä»–</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label section-subtitle" data-number="8">æ˜¯å¦ç»§ç»­ä¸‹ä¸€æ­¥</label>
                                                <select class="form-select" id="contact_added">
                                                    <option value="">è¯·é€‰æ‹©</option>
                                                    <option value="å·²åŠ ä¸Š">âœ… å·²åŠ ä¸Š</option>
                                                    <option value="æœªç»§ç»­">âŒ æœªç»§ç»­</option>
                                                    <option value="å¾…éªŒè¯">â³ å¾…éªŒè¯</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- ç¬¬äºŒæ­¥ï¼šæµé‡åˆ†æ -->
                                <div class="form-section" data-section="2">
                                    <div class="section-header">
                                        <h4 class="section-title">Â· æµé‡åˆ†æ</h4>
                                        <p class="section-subtitle">åˆ†æåŒè¡Œçš„æµé‡è·å–å’Œè¿è¥ç­–ç•¥</p>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">æµé‡é˜µåœ° <span class="text-muted">(å¯å¤šé€‰)</span></label>
                                        <div class="platform-selector">
                                            <!-- ä¸»è¦å†…å®¹å¹³å° -->
                                            <div class="platform-category">
                                                <small class="text-muted d-block mb-2">ğŸ“± ä¸»è¦å†…å®¹å¹³å°</small>
                                                <div class="platform-chip" data-platform="å°çº¢ä¹¦">ğŸ“± å°çº¢ä¹¦</div>
                                                <div class="platform-chip" data-platform="æŠ–éŸ³">ğŸµ æŠ–éŸ³</div>
                                                <div class="platform-chip" data-platform="çŸ¥ä¹">ğŸ“š çŸ¥ä¹</div>
                                                <div class="platform-chip" data-platform="Bç«™">ğŸ“º Bç«™</div>
                                                <div class="platform-chip" data-platform="å¾®åš">ğŸ”„ å¾®åš</div>
                                                <div class="platform-chip" data-platform="å¿«æ‰‹">âš¡ å¿«æ‰‹</div>
                                            </div>
                                            
                                            <!-- ç§åŸŸå¹³å° -->
                                            <div class="platform-category mt-3">
                                                <small class="text-muted d-block mb-2">ğŸ’¬ ç§åŸŸå¹³å°</small>
                                                <div class="platform-chip" data-platform="å¾®ä¿¡">ğŸ’¬ å¾®ä¿¡</div>
                                                <div class="platform-chip" data-platform="å…¬ä¼—å·">ğŸ“– å…¬ä¼—å·</div>
                                                <div class="platform-chip" data-platform="è§†é¢‘å·">ğŸ“¹ è§†é¢‘å·</div>
                                                <div class="platform-chip" data-platform="ä¼ä¸šå¾®ä¿¡">ğŸ¢ ä¼ä¸šå¾®ä¿¡</div>
                                            </div>
                                            
                                            <!-- ç¤¾ç¾¤å¹³å° -->
                                            <div class="platform-category mt-3">
                                                <small class="text-muted d-block mb-2">ğŸ‘¥ ç¤¾ç¾¤å¹³å°</small>
                                                <div class="platform-chip" data-platform="æ´»åŠ¨è¡Œ">ğŸ« æ´»åŠ›è¡Œ</div>
                                                <div class="platform-chip" data-platform="å–ä¼™">ğŸ¤ å–ä¼™</div>
                                                <div class="platform-chip" data-platform="çŸ¥è¯†æ˜Ÿçƒ">ğŸŒŸ çŸ¥è¯†æ˜Ÿçƒ</div>
                                                <div class="platform-chip" data-platform="å°æ‰“å¡">ğŸ“… å°æ‰“å¡</div>
                                                <div class="platform-chip" data-platform="å°å®‡å®™">ğŸ§ å°å®‡å®™</div>
                                                <div class="platform-chip" data-platform="å³åˆ»">âš¡ å³åˆ»</div>
                                            </div>
                                            
                                            <!-- ç”µå•†å¹³å° -->
                                            <div class="platform-category mt-3">
                                                <small class="text-muted d-block mb-2">ğŸ›’ ç”µå•†å¹³å°</small>
                                                <div class="platform-chip" data-platform="æ·˜å®">ğŸ›’ æ·˜å®</div>
                                                <div class="platform-chip" data-platform="é—²é±¼">ğŸŸ é—²é±¼</div>
                                                <div class="platform-chip" data-platform="äº¬ä¸œ">ğŸ›ï¸ äº¬ä¸œ</div>
                                                <div class="platform-chip" data-platform="æ‹¼å¤šå¤š">ğŸ”¥ æ‹¼å¤šå¤š</div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label section-subtitle" data-number="9">æµé‡è·¯å¾„ç±»å‹</label>
                                        <select class="form-select" id="traffic_path_type">
                                            <option value="">è¯·é€‰æ‹©è·¯å¾„ç±»å‹</option>
                                            <option value="å†…å®¹ç§è‰å‹">ğŸ“ å†…å®¹ç§è‰å‹ (å†…å®¹â†’äº’åŠ¨â†’å’¨è¯¢â†’è½¬åŒ–)</option>
                                            <option value="ç›´æ’­å¼•æµå‹">ğŸ“¹ ç›´æ’­å¼•æµå‹ (ç›´æ’­â†’é™æ—¶â†’ç«‹å³æˆäº¤)</option>
                                            <option value="æœç´¢ä¼˜åŒ–å‹">ğŸ” æœç´¢ä¼˜åŒ–å‹ (æœç´¢â†’å’¨è¯¢â†’1v1è½¬åŒ–)</option>
                                            <option value="ç¤¾ç¾¤è¿è¥å‹">ğŸ‘¥ ç¤¾ç¾¤è¿è¥å‹ (ç¤¾ç¾¤â†’äº’åŠ¨â†’ç§åŸŸâ†’è½¬åŒ–)</option>
                                            <option value="å·¥å…·å¼•æµå‹">ğŸ› ï¸ å·¥å…·å¼•æµå‹ (å·¥å…·â†’ä½“éªŒâ†’ä»˜è´¹â†’å‡çº§)</option>
                                            <option value="ç”µå•†å¼•æµå‹">ğŸ›’ ç”µå•†å¼•æµå‹ (å•†å“å¼•æµâ†’ç§åŸŸæ²‰æ·€â†’äº¤ä»˜è½¬åŒ–â†’å‡å•å¤è´­)</option>
                                            <option value="çº¯ç”µå•†å‹">ğŸ›ï¸ çº¯ç”µå•†å‹ (å•†å“å±•ç¤ºâ†’å’¨è¯¢æˆäº¤â†’å¹³å°äº¤ä»˜â†’å®Œæˆ)</option>
                                        </select>
                                        <div class="form-text text-muted">
                                            ğŸ’¡ è¯´æ˜ï¼šç”µå•†å¼•æµå‹é€‚åˆè™šæ‹Ÿå•†å“ï¼Œé€šè¿‡ä½ä»·äº§å“å¼•æµåˆ°ç§åŸŸï¼Œåç»­æä¾›è®­ç»ƒè¥ã€é™ªè·‘ç­‰æœåŠ¡ï¼›çº¯ç”µå•†å‹é€‚åˆå®ç‰©å•†å“ï¼Œåœ¨å¹³å°å†…å®Œæˆæ•´ä¸ªäº¤æ˜“æµç¨‹
                                        </div>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label section-subtitle" data-number="10">æµé‡è·¯å¾„</label>
                                        <div class="traffic-path-display">
                                            <div class="path-preview p-3 bg-light rounded mb-3">
                                                <small class="text-muted">è‡ªåŠ¨ç”Ÿæˆçš„æµé‡è·¯å¾„ï¼š</small>
                                                <div class="generated-path" id="generated_path">
                                                    è¯·å…ˆé€‰æ‹©è°ƒç ”å¹³å°
                                                </div>
                                            </div>
                                            <div class="form-text text-muted">
                                                ğŸ’¡ è¯´æ˜ï¼šæ ¹æ®æ‚¨é€‰æ‹©è°ƒç ”å¹³å°çš„é¡ºåºè‡ªåŠ¨ç”Ÿæˆæµé‡è·¯å¾„ã€‚ä¾‹å¦‚ï¼šå…ˆé€‰æ‹©å°çº¢ä¹¦ï¼Œå†é€‰æ‹©å¾®ä¿¡ï¼Œè·¯å¾„ä¼šæ˜¾ç¤ºä¸º"å°çº¢ä¹¦â†’å¾®ä¿¡"
                                            </div>
                                        </div>
                                    </div>

      
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label section-subtitle" data-number="11">å†…å®¹å‘å¸ƒé¢‘ç‡</label>
                                                <select class="form-select" id="content_frequency">
                                                    <option value="">è¯·é€‰æ‹©</option>
                                                    <option value="æ—¥æ›´">ğŸ“… æ—¥æ›´</option>
                                                    <option value="å‘¨æ›´2-3æ¬¡">ğŸ“† å‘¨æ›´2-3æ¬¡</option>
                                                    <option value="å‘¨æ›´1æ¬¡">ğŸ“† å‘¨æ›´1æ¬¡</option>
                                                    <option value="æœˆæ›´å‡ æ¬¡">ğŸ“… æœˆæ›´å‡ æ¬¡</option>
                                                    <option value="ä¸å›ºå®š">â“ ä¸å›ºå®š</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label section-subtitle" data-number="12">äº’åŠ¨æ´»è·ƒåº¦</label>
                                                <select class="form-select" id="interaction_level">
                                                    <option value="">è¯·é€‰æ‹©</option>
                                                    <option value="å¾ˆé«˜">ğŸ”¥ å¾ˆé«˜ (ç§’å›)</option>
                                                    <option value="è¾ƒé«˜">ğŸ‘ è¾ƒé«˜ (å°æ—¶å†…å›å¤)</option>
                                                    <option value="ä¸€èˆ¬">âš–ï¸ ä¸€èˆ¬ (24å°æ—¶å†…å›å¤)</option>
                                                    <option value="è¾ƒä½">ğŸ“± è¾ƒä½ (å›å¤æ…¢)</option>
                                                    <option value="å¾ˆä½">ğŸ˜´ å¾ˆä½ (åŸºæœ¬ä¸å›)</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- ç¬¬ä¸‰æ­¥ï¼šäº§å“åˆ†æ -->
                                <div class="form-section" data-section="3">
                                    <div class="section-header">
                                        <h4 class="section-title">Â· äº§å“åˆ†æ</h4>
                                        <p class="section-subtitle">æ·±å…¥äº†è§£åŒè¡Œçš„äº§å“è®¾è®¡å’Œå˜ç°æ¨¡å¼</p>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">ä¸»è¦å–ä»€ä¹ˆï¼Ÿ</label>
                                        <input type="text" class="form-control" id="product_main" placeholder="æ¯”å¦‚ï¼šç†è´¢è¯¾ç¨‹ã€å¥èº«æŒ‡å¯¼ã€ç¾å¦†äº§å“...">
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label section-subtitle" data-number="14">äº§å“ç±»å‹ <span class="text-muted">(å¯å¤šé€‰)</span></label>
                                        <div class="product-types-grid">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="å®ç‰©äº§å“" id="product_physical">
                                                <label class="form-check-label" for="product_physical">
                                                    ğŸ“¦ å®ç‰©äº§å“
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="è™šæ‹Ÿäº§å“" id="product_digital">
                                                <label class="form-check-label" for="product_digital">
                                                    ğŸ’» è™šæ‹Ÿäº§å“
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="æœåŠ¡ç±»" id="product_service">
                                                <label class="form-check-label" for="product_service">
                                                    ğŸ›ï¸ æœåŠ¡ç±»
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="çŸ¥è¯†ä»˜è´¹" id="product_knowledge">
                                                <label class="form-check-label" for="product_knowledge">
                                                    ğŸ“š çŸ¥è¯†ä»˜è´¹
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="è½¯ä»¶å·¥å…·" id="product_software">
                                                <label class="form-check-label" for="product_software">
                                                    ğŸ”§ è½¯ä»¶å·¥å…·
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="ä¼šå‘˜è®¢é˜…" id="product_subscription">
                                                <label class="form-check-label" for="product_subscription">
                                                    ğŸ’³ ä¼šå‘˜è®¢é˜…
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="é«˜å®¢å•å®šåˆ¶" id="product_custom">
                                                <label class="form-check-label" for="product_custom">
                                                    ğŸ’ é«˜å®¢å•å®šåˆ¶
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label section-subtitle" data-number="15">äº§å“å±‚çº§è®¾è®¡</label>
                                        <div class="row">
                                            <div class="col-md-4">
                                                <div class="card">
                                                    <div class="card-body text-center">
                                                        <h6 class="card-title">ğŸ¯ å¼•æµäº§å“</h6>
                                                        <input type="text" class="form-control form-control-sm mb-2" id="product_entry" placeholder="ä½“éªŒè¯¾/å°äº§å“/ç¦åˆ©">
                                                        <input type="text" class="form-control form-control-sm mb-2" id="price_entry" placeholder="ä»·æ ¼">
                                                        <select class="form-select form-select-sm mb-2" id="delivery_method_entry">
                                                            <option value="">äº¤ä»˜æ–¹å¼</option>
                                                            <option value="è‡ªåŠ¨å‘è´§">ğŸ¤– è‡ªåŠ¨å‘è´§</option>
                                                            <option value="äººå·¥äº¤ä»˜">ğŸ‘¤ äººå·¥äº¤ä»˜</option>
                                                            <option value="é¢„çº¦æœåŠ¡">ğŸ“… é¢„çº¦æœåŠ¡</option>
                                                            <option value="å®šåˆ¶å¼€å‘">âš™ï¸ å®šåˆ¶å¼€å‘</option>
                                                        </select>
                                                        <input type="text" class="form-control form-control-sm" id="delivery_period_entry" placeholder="äº¤ä»˜å‘¨æœŸ">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="card">
                                                    <div class="card-body text-center">
                                                        <h6 class="card-title">ğŸ’° ä¸»è¦äº§å“</h6>
                                                        <input type="text" class="form-control form-control-sm mb-2" id="product_mid" placeholder="ç³»ç»Ÿè¯¾/æ ‡å‡†æœåŠ¡">
                                                        <input type="text" class="form-control form-control-sm mb-2" id="price_mid" placeholder="ä»·æ ¼">
                                                        <select class="form-select form-select-sm mb-2" id="delivery_method_mid">
                                                            <option value="">äº¤ä»˜æ–¹å¼</option>
                                                            <option value="è‡ªåŠ¨å‘è´§">ğŸ¤– è‡ªåŠ¨å‘è´§</option>
                                                            <option value="äººå·¥äº¤ä»˜">ğŸ‘¤ äººå·¥äº¤ä»˜</option>
                                                            <option value="é¢„çº¦æœåŠ¡">ğŸ“… é¢„çº¦æœåŠ¡</option>
                                                            <option value="å®šåˆ¶å¼€å‘">âš™ï¸ å®šåˆ¶å¼€å‘</option>
                                                        </select>
                                                        <input type="text" class="form-control form-control-sm" id="delivery_period_mid" placeholder="äº¤ä»˜å‘¨æœŸ">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="card">
                                                    <div class="card-body text-center">
                                                        <h6 class="card-title">ğŸ‘‘ é«˜ç«¯äº§å“</h6>
                                                        <input type="text" class="form-control form-control-sm mb-2" id="product_high" placeholder="é«˜ç«¯å®šåˆ¶/1v1æœåŠ¡">
                                                        <input type="text" class="form-control form-control-sm mb-2" id="price_high" placeholder="ä»·æ ¼">
                                                        <select class="form-select form-select-sm mb-2" id="delivery_method_high">
                                                            <option value="">äº¤ä»˜æ–¹å¼</option>
                                                            <option value="äººå·¥äº¤ä»˜">ğŸ‘¤ äººå·¥äº¤ä»˜</option>
                                                            <option value="é¢„çº¦æœåŠ¡">ğŸ“… é¢„çº¦æœåŠ¡</option>
                                                            <option value="å®šåˆ¶å¼€å‘">âš™ï¸ å®šåˆ¶å¼€å‘</option>
                                                            <option value="ä¸“å±æœåŠ¡">ğŸ¯ ä¸“å±æœåŠ¡</option>
                                                        </select>
                                                        <input type="text" class="form-control form-control-sm" id="delivery_period_high" placeholder="äº¤ä»˜å‘¨æœŸ">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label section-subtitle" data-number="16">å…·ä½“äº¤ä»˜å½¢å¼ <span class="text-muted">(å¯å¤šé€‰)</span></label>
                                        <div class="delivery-methods-grid">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="è‡ªåŠ¨å‘è´§" id="delivery_auto">
                                                <label class="form-check-label" for="delivery_auto">
                                                    ğŸ¤– è‡ªåŠ¨å‘è´§
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="äººå·¥å¯¹æ¥" id="delivery_manual">
                                                <label class="form-check-label" for="delivery_manual">
                                                    ğŸ‘¨â€ğŸ’¼ äººå·¥å¯¹æ¥
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="ç›´æ’­æˆè¯¾" id="delivery_live">
                                                <label class="form-check-label" for="delivery_live">
                                                    ğŸ“º ç›´æ’­æˆè¯¾
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="å½•æ’­è¯¾ç¨‹" id="delivery_recorded">
                                                <label class="form-check-label" for="delivery_recorded">
                                                    ğŸ¬ å½•æ’­è¯¾ç¨‹
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="1v1å’¨è¯¢" id="delivery_1v1">
                                                <label class="form-check-label" for="delivery_1v1">
                                                    ğŸ’¼ 1v1å’¨è¯¢
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="è®­ç»ƒè¥" id="delivery_camp">
                                                <label class="form-check-label" for="delivery_camp">
                                                    ğŸƒ è®­ç»ƒè¥
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="é™ªè·‘æœåŠ¡" id="delivery_coaching">
                                                <label class="form-check-label" for="delivery_coaching">
                                                    ğŸƒâ€â™‚ï¸ é™ªè·‘æœåŠ¡
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="ç¤¾ç¾¤æœåŠ¡" id="delivery_community">
                                                <label class="form-check-label" for="delivery_community">
                                                    ğŸ‘¥ ç¤¾ç¾¤æœåŠ¡
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="çº¿ä¸‹æœåŠ¡" id="delivery_offline">
                                                <label class="form-check-label" for="delivery_offline">
                                                    ğŸª çº¿ä¸‹æœåŠ¡
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="å…¶ä»–" id="delivery_other">
                                                <label class="form-check-label" for="delivery_other">
                                                    ğŸ“Œ å…¶ä»–
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label section-subtitle" data-number="17">ä¸»è¦äº¤ä»˜åœ°ç‚¹</label>
                                        <select class="form-select" id="delivery_location">
                                            <option value="">è¯·é€‰æ‹©</option>
                                            <option value="å¹³å°å†…äº¤ä»˜">ğŸ›’ å¹³å°å†…äº¤ä»˜ (é—²é±¼/æ·˜å®ç­‰)</option>
                                            <option value="ç§åŸŸäº¤ä»˜">ğŸ’¬ ç§åŸŸäº¤ä»˜ (å¾®ä¿¡/ä¼ä¸šå¾®ä¿¡)</option>
                                            <option value="ç¬¬ä¸‰æ–¹å¹³å°">ğŸŒ ç¬¬ä¸‰æ–¹å¹³å° (çŸ¥è¯†æ˜Ÿçƒ/å°é¹…é€šç­‰)</option>
                                            <option value="æ··åˆäº¤ä»˜">ğŸ”„ æ··åˆäº¤ä»˜ (å¤šå¹³å°ç»“åˆ)</option>
                                        </select>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label section-subtitle" data-number="18">å˜ç°å½¢å¼ <span class="text-muted">(å¯å¤šé€‰)</span></label>
                                        <div class="monetization-types-grid">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="ç›´é”€" id="monetization_direct">
                                                <label class="form-check-label" for="monetization_direct">
                                                    ğŸ¯ ç›´é”€ (ç›´æ¥é”€å”®ç»™ç»ˆç«¯ç”¨æˆ·)
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="åˆ†é”€" id="monetization_distribution">
                                                <label class="form-check-label" for="monetization_distribution">
                                                    ğŸ‘¥ åˆ†é”€ (é€šè¿‡ä»£ç†/æ¨å¹¿è€…é”€å”®)
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="è”ç›Ÿè¥é”€" id="monetization_affiliate">
                                                <label class="form-check-label" for="monetization_affiliate">
                                                    ğŸ”— è”ç›Ÿè¥é”€ (ä½£é‡‘åˆ†æˆæ¨¡å¼)
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="ä¼šå‘˜è®¢é˜…" id="monetization_subscription">
                                                <label class="form-check-label" for="monetization_subscription">
                                                    ğŸ’³ ä¼šå‘˜è®¢é˜… (å®šæœŸæ”¶è´¹)
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="å¹¿å‘Šå˜ç°" id="monetization_ads">
                                                <label class="form-check-label" for="monetization_ads">
                                                    ğŸ“¢ å¹¿å‘Šå˜ç° (æµé‡å¹¿å‘Šæ”¶å…¥)
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="å¹³å°ä½£é‡‘" id="monetization_commission">
                                                <label class="form-check-label" for="monetization_commission">
                                                    ğŸª å¹³å°ä½£é‡‘ (äº¤æ˜“æŠ½æˆ)
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="æœåŠ¡è´¹" id="monetization_service">
                                                <label class="form-check-label" for="monetization_service">
                                                    ğŸ›ï¸ æœåŠ¡è´¹ (å’¨è¯¢/æŠ€æœ¯æœåŠ¡)
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="åŠ ç›Ÿæˆæƒ" id="monetization_franchise">
                                                <label class="form-check-label" for="monetization_franchise">
                                                    ğŸ“œ åŠ ç›Ÿæˆæƒ (å“ç‰Œ/æŠ€æœ¯æˆæƒ)
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="è‚¡æƒåˆä½œ" id="monetization_equity">
                                                <label class="form-check-label" for="monetization_equity">
                                                    ğŸ“ˆ è‚¡æƒåˆä½œ (æŠ•èµ„/åˆ†çº¢)
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label section-subtitle" data-number="19">æ ¸å¿ƒå–ç‚¹</label>
                                        <textarea class="form-control" id="product_selling_point" rows="2" placeholder="æœ€å¸å¼•äººçš„ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ"></textarea>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label">å®šä»·ç­–ç•¥</label>
                                        <select class="form-select" id="pricing_strategy">
                                            <option value="">è¯·é€‰æ‹©</option>
                                            <option value="ä½ä»·èµ°é‡">ğŸ’° ä½ä»·èµ°é‡</option>
                                            <option value="ä¸­ç­‰å®šä»·">âš–ï¸ ä¸­ç­‰å®šä»·</option>
                                            <option value="é«˜ç«¯å®šä½">ğŸ‘‘ é«˜ç«¯å®šä½</option>
                                            <option value="åˆ†å±‚å®šä»·">ğŸ“Š åˆ†å±‚å®šä»·</option>
                                            <option value="è®¢é˜…åˆ¶">ğŸ’³ è®¢é˜…åˆ¶</option>
                                        </select>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label">ä¼˜æƒ æ´»åŠ¨</label>
                                        <input type="text" class="form-control" id="promotion_info" placeholder="é™æ—¶ä¼˜æƒ /å¥—é¤æŠ˜æ‰£/æ»¡å‡æ´»åŠ¨ç­‰">
                                    </div>
                                </div>

                                <!-- ç¬¬å››æ­¥ï¼šè¿è¥åˆ†æ -->
                                <div class="form-section" data-section="4">
                                    <div class="section-header">
                                        <h4 class="section-title">Â· è¿è¥åˆ†æ</h4>
                                        <p class="section-subtitle">è¯„ä¼°åŒè¡Œçš„è¿è¥èƒ½åŠ›å’Œå•†ä¸šä»·å€¼</p>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label section-subtitle" data-number="20">çœ‹åˆ°çš„è·å®¢æ¸ é“ <span class="text-muted">(ä½ å‘ç°çš„æ¸ é“)</span></label>
                                        <select class="form-select" id="acquisition_channel">
                                            <option value="">è¯·é€‰æ‹©çœ‹åˆ°çš„è·å®¢æ¸ é“</option>
                                            <option value="è‡ªç„¶æ¨è">ğŸŒ± è‡ªç„¶æ¨è (å¹³å°æ¨è/ç®—æ³•æ¨è)</option>
                                            <option value="ä»˜è´¹å¹¿å‘Š">ğŸ’° ä»˜è´¹å¹¿å‘Š (ä¿¡æ¯æµ/æœç´¢å¹¿å‘Š)</option>
                                            <option value="å†…å®¹å¼•æµ">ğŸ“ å†…å®¹å¼•æµ (å›¾æ–‡/è§†é¢‘/ç›´æ’­)</option>
                                            <option value="ç§åŸŸè½¬åŒ–">ğŸ‘¥ ç§åŸŸè½¬åŒ– (æœ‹å‹åœˆ/ç¤¾ç¾¤è½¬å‘)</option>
                                            <option value="åˆä½œæ¨å¹¿">ğŸ¤ åˆä½œæ¨å¹¿ (KOL/è¾¾äºº/åˆ†é”€)</option>
                                            <option value="å£ç¢‘ä¼ æ’­">ğŸ—£ï¸ å£ç¢‘ä¼ æ’­ (ç”¨æˆ·åˆ†äº«/è¯„ä»·)</option>
                                            <option value="æœç´¢å‘ç°">ğŸ” æœç´¢å‘ç° (ä¸»åŠ¨æœç´¢æ‰¾åˆ°)</option>
                                            <option value="å•†å“å¼•æµ">ğŸ›’ å•†å“å¼•æµ (ä½ä»·äº§å“å¼•æµ)</option>
                                            <option value="ä¸æ¸…æ¥š">â“ ä¸æ¸…æ¥š/æ— æ³•åˆ¤æ–­</option>
                                        </select>
                                        <div class="form-text text-muted">
                                            ğŸ’¡ å¡«å†™ä½ å‘ç°çš„è·å®¢æ¸ é“ï¼Œä¸ä¸€å®šæ˜¯å¯¹æ–¹çš„å…¨éƒ¨æ¸ é“
                                        </div>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label section-subtitle" data-number="21">è½¬åŒ–è·¯å¾„è®¾è®¡</label>
                                        <select class="form-select" id="conversion_path_template">
                                            <option value="">é€‰æ‹©è½¬åŒ–è·¯å¾„æ¨¡æ¿</option>
                                            <option value="å†…å®¹ç§è‰è·¯å¾„">ğŸ“ å†…å®¹ç§è‰ï¼šå†…å®¹å¸å¼•â†’äº’åŠ¨å’¨è¯¢â†’ç§åŸŸè½¬åŒ–â†’æˆäº¤å¤è´­</option>
                                            <option value="ç›´æ’­è½¬åŒ–è·¯å¾„">ğŸ“º ç›´æ’­è½¬åŒ–ï¼šç›´æ’­å¼•æµâ†’é™æ—¶ä¼˜æƒ â†’ç«‹å³ä¸‹å•â†’å”®åç»´æŠ¤</option>
                                            <option value="æœç´¢ä¼˜åŒ–è·¯å¾„">ğŸ” æœç´¢ä¼˜åŒ–ï¼šæœç´¢æ’åâ†’ä¸»åŠ¨å’¨è¯¢â†’ä¸“ä¸šè§£ç­”â†’1v1æˆäº¤</option>
                                            <option value="ç¤¾ç¾¤è¿è¥è·¯å¾„">ğŸ‘¥ ç¤¾ç¾¤è¿è¥ï¼šç¤¾ç¾¤å¸å¼•â†’ä»·å€¼è¾“å‡ºâ†’ä¿¡ä»»å»ºç«‹â†’äº§å“è½¬åŒ–</option>
                                            <option value="å·¥å…·å¼•æµè·¯å¾„">ğŸ› ï¸ å·¥å…·å¼•æµï¼šå…è´¹å·¥å…·â†’ä½“éªŒäº§å“â†’ä»˜è´¹å‡çº§â†’æŒç»­æœåŠ¡</option>
                                            <option value="ç”µå•†å¼•æµè·¯å¾„">ğŸ›’ ç”µå•†å¼•æµï¼šä½ä»·äº§å“â†’ç§åŸŸæ²‰æ·€â†’åŸºç¡€äº¤ä»˜â†’ä¿¡ä»»å»ºç«‹â†’é«˜ä»·äº§å“â†’æŒç»­æœåŠ¡</option>
                                            <option value="çº¯ç”µå•†è·¯å¾„">ğŸ›ï¸ çº¯ç”µå•†ï¼šå•†å“å±•ç¤ºâ†’å’¨è¯¢æ²Ÿé€šâ†’å¹³å°æˆäº¤â†’å‘è´§äº¤ä»˜â†’å”®åæœåŠ¡</option>
                                        </select>
                                        <textarea class="form-control mt-2" id="conversion_path" rows="2" placeholder="æˆ–è€…è‡ªå®šä¹‰æè¿°è½¬åŒ–è·¯å¾„..."></textarea>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label section-subtitle" data-number="22">å®¢æˆ·ç»´æŠ¤æ–¹å¼</label>
                                        <select class="form-select" id="customer_maintenance">
                                            <option value="">è¯·é€‰æ‹©</option>
                                            <option value="ç¤¾ç¾¤è¿è¥">ğŸ‘¥ ç¤¾ç¾¤è¿è¥</option>
                                            <option value="1v1æœåŠ¡">ğŸ’¼ 1v1æœåŠ¡</option>
                                            <option value="è‡ªåŠ¨å›å¤">ğŸ¤– è‡ªåŠ¨å›å¤</option>
                                            <option value="å®šæœŸè·Ÿè¿›">ğŸ“… å®šæœŸè·Ÿè¿›</option>
                                            <option value="ä¼šå‘˜ä½“ç³»">ğŸ’³ ä¼šå‘˜ä½“ç³»</option>
                                        </select>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label section-subtitle" data-number="23">å”®åæœåŠ¡å†…å®¹ <span class="text-muted">(å¯å¤šé€‰)</span></label>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="after_sales_qa">
                                                    <label class="form-check-label" for="after_sales_qa">â“ ç­”ç–‘è§£æƒ‘</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="after_sales_update">
                                                    <label class="form-check-label" for="after_sales_update">ğŸ”„ å†…å®¹æ›´æ–°</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="after_sales_community">
                                                    <label class="form-check-label" for="after_sales_community">ğŸ‘¥ ç¤¾ç¾¤é™ªä¼´</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="after_sales_1v1">
                                                    <label class="form-check-label" for="after_sales_1v1">ğŸ’¼ 1v1æŒ‡å¯¼</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="after_sales_material">
                                                    <label class="form-check-label" for="after_sales_material">ğŸ“š ç´ ææä¾›</label>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="after_sales_tools">
                                                    <label class="form-check-label" for="after_sales_tools">ğŸ› ï¸ å·¥å…·æ”¯æŒ</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="after_sales_certification">
                                                    <label class="form-check-label" for="after_sales_certification">ğŸ“œ è®¤è¯è¯ä¹¦</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="after_sales_refund">
                                                    <label class="form-check-label" for="after_sales_refund">ğŸ’° é€€æ¬¾ä¿éšœ</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="after_sales_lifetime">
                                                    <label class="form-check-label" for="after_sales_lifetime">ğŸŒŸ ç»ˆèº«æœåŠ¡</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" id="after_sales_none">
                                                    <label class="form-check-label" for="after_sales_none">âŒ æ— å”®åæœåŠ¡</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label section-subtitle" data-number="24">å”®åæœåŠ¡å¤‡æ³¨</label>
                                        <textarea class="form-control" id="after_sales_remarks" rows="2" placeholder="è¡¥å……è¯´æ˜å”®åæœåŠ¡çš„ç‰¹ç‚¹ã€æœŸé™ã€æ³¨æ„äº‹é¡¹ç­‰"></textarea>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label section-subtitle" data-number="25">å®¢æˆ·ç»´æŠ¤ç­–ç•¥</label>
                                        <textarea class="form-control" id="customer_maintenance_strategy" rows="2" placeholder="å¦‚ä½•ç»´æŠ¤å®¢æˆ·å…³ç³»ï¼Ÿæ¯”å¦‚å®šæœŸè·Ÿè¿›ã€ä¸“å±ç¾¤ã€ä¸ªæ€§åŒ–æœåŠ¡ç­‰"></textarea>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label section-subtitle" data-number="26">å¤è´­ç­–ç•¥</label>
                                        <textarea class="form-control" id="repurchase_strategy" rows="2" placeholder="å¦‚ä½•è®©å®¢æˆ·é‡å¤è´­ä¹°ï¼Ÿ"></textarea>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label">è¥æ”¶æ°´å¹³</label>
                                                <select class="form-select" id="revenue_estimate">
                                                    <option value="">è¯·é€‰æ‹©</option>
                                                    <option value="åˆšèµ·æ­¥">ğŸŒ± åˆšèµ·æ­¥ (å¯èƒ½è¿˜æ²¡ç›ˆåˆ©)</option>
                                                    <option value="æœ‰æ”¶å…¥">ğŸ’µ æœ‰æ”¶å…¥ (ä½†ä¸ç¨³å®š)</option>
                                                    <option value="ç¨³å®šç›ˆåˆ©">ğŸ’° ç¨³å®šç›ˆåˆ© (æœˆå…¥è¿‡ä¸‡)</option>
                                                    <option value="å¾ˆæˆåŠŸ">ğŸ† å¾ˆæˆåŠŸ (æœˆå…¥å‡ ä¸‡+)</option>
                                                    <option value="ä¸æ¸…æ¥š">â“ çœ‹ä¸å‡ºæ¥</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label">ä¿¡ä»»åº¦è¯„åˆ†</label>
                                                <select class="form-select" id="trust_score">
                                                    <option value="">è¯·é€‰æ‹©</option>
                                                    <option value="5-éå¸¸é è°±">â­â­â­â­â­ éå¸¸é è°±</option>
                                                    <option value="4-æ¯”è¾ƒé è°±">â­â­â­â­ æ¯”è¾ƒé è°±</option>
                                                    <option value="3-ä¸€èˆ¬èˆ¬">â­â­â­ ä¸€èˆ¬èˆ¬</option>
                                                    <option value="2-ä¸å¤ªé è°±">â­â­ ä¸å¤ªé è°±</option>
                                                    <option value="1-å¾ˆä¸é è°±">â­ å¾ˆä¸é è°±</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label">å‚è€ƒä»·å€¼è¯„ä¼°</label>
                                        <select class="form-select" id="reference_value">
                                            <option value="">è¯·é€‰æ‹©</option>
                                            <option value="éå¸¸æœ‰ä»·å€¼">ğŸ¯ éå¸¸æœ‰ä»·å€¼ (å€¼å¾—æ·±å…¥å­¦ä¹ )</option>
                                            <option value="è¾ƒæœ‰ä»·å€¼">ğŸ‘ è¾ƒæœ‰ä»·å€¼ (å¯ä»¥å€Ÿé‰´)</option>
                                            <option value="ä¸€èˆ¬ä»·å€¼">âš–ï¸ ä¸€èˆ¬ä»·å€¼ (å‚è€ƒå³å¯)</option>
                                            <option value="ä»·å€¼ä¸å¤§">ğŸ“± ä»·å€¼ä¸å¤§ (çœ‹çœ‹å°±è¡Œ)</option>
                                        </select>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label">å€¼å¾—å­¦ä¹ çš„åœ°æ–¹</label>
                                        <textarea class="form-control" id="learning_points" rows="3" placeholder="è¿™ä¸ªåŒè¡Œæœ‰å“ªäº›åšæ³•å€¼å¾—å­¦ä¹ ï¼Ÿ"></textarea>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label">éœ€è¦æ”¹è¿›çš„åœ°æ–¹</label>
                                        <textarea class="form-control" id="improvement_points" rows="2" placeholder="è¿™ä¸ªåŒè¡Œæœ‰å“ªäº›åœ°æ–¹å¯ä»¥åšå¾—æ›´å¥½ï¼Ÿ"></textarea>
                                    </div>
                                </div>

                                <!-- å¯¼èˆªæŒ‰é’® -->
                                <div class="d-flex justify-content-between mt-4">
                                    <button type="button" class="btn btn-secondary" id="prev-btn" style="display: none;">ä¸Šä¸€æ­¥</button>
                                    <div class="ms-auto">
                                        <button type="button" class="btn btn-primary" id="next-btn">ä¸‹ä¸€æ­¥</button>
                                        <button type="submit" class="btn btn-success" id="submit-btn" style="display: none;">æäº¤è°ƒç ”</button>
                                        <button type="button" class="btn btn-outline-success ms-2" id="quick-submit-btn">å¿«é€Ÿæäº¤</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- åˆ—è¡¨é¡µé¢ -->
        <div id="list-page" class="tab-content" style="display: none;">
            <div class="row">
                <div class="col-12">
                    <!-- ç­›é€‰åŒºåŸŸ -->
                    <div class="filter-section">
                        <div class="row">
                            <div class="col-md-3">
                                <label class="form-label">å¹³å°ç­›é€‰</label>
                                <select class="form-select" id="filter-platform">
                                    <option value="">å…¨éƒ¨å¹³å°</option>
                                    <option value="å°çº¢ä¹¦">å°çº¢ä¹¦</option>
                                    <option value="æŠ–éŸ³">æŠ–éŸ³</option>
                                    <option value="çŸ¥ä¹">çŸ¥ä¹</option>
                                    <option value="å¾®ä¿¡">å¾®ä¿¡</option>
                                    <option value="Bç«™">Bç«™</option>
                                    <option value="å¾®åš">å¾®åš</option>
                                    <option value="é—²é±¼">é—²é±¼</option>
                                    <option value="æ·˜å®">æ·˜å®</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">å®¢å•ä»·ç­›é€‰</label>
                                <select class="form-select" id="filter-price">
                                    <option value="">å…¨éƒ¨ä»·æ ¼</option>
                                    <option value="å¼•æµå±‚">å¼•æµå±‚ (9.9-99å…ƒ)</option>
                                    <option value="è½¬åŒ–å±‚">è½¬åŒ–å±‚ (199-999å…ƒ)</option>
                                    <option value="é«˜å®¢å•å±‚">é«˜å®¢å•å±‚ (1000+å…ƒ)</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">ä¿¡ä»»åº¦ç­›é€‰</label>
                                <select class="form-select" id="filter-trust">
                                    <option value="">å…¨éƒ¨</option>
                                    <option value="5-éå¸¸é è°±">5æ˜Ÿ - éå¸¸é è°±</option>
                                    <option value="4-æ¯”è¾ƒé è°±">4æ˜Ÿ - æ¯”è¾ƒé è°±</option>
                                    <option value="3-ä¸€èˆ¬èˆ¬">3æ˜Ÿ - ä¸€èˆ¬èˆ¬</option>
                                    <option value="2-ä¸å¤ªé è°±">2æ˜Ÿ - ä¸å¤ªé è°±</option>
                                    <option value="1-å¾ˆä¸é è°±">1æ˜Ÿ - å¾ˆä¸é è°±</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">æœç´¢</label>
                                <input type="text" class="form-control" id="search-input" placeholder="æœç´¢æ˜µç§°ã€æè¿°...">
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-12">
                                <button class="btn btn-outline-primary export-btn" onclick="exportData('excel')">ğŸ“Š å¯¼å‡ºExcel</button>
                                <button class="btn btn-outline-success export-btn" onclick="exportData('csv')">ğŸ“„ å¯¼å‡ºCSV</button>
                                <button class="btn btn-outline-info export-btn" onclick="exportData('json')">ğŸ’¾ å¯¼å‡ºJSON</button>
                                <button class="btn btn-outline-warning export-btn" onclick="exportAnalysisReport()">ğŸ“ˆ å¯¼å‡ºåˆ†ææŠ¥å‘Š</button>
                                <button class="btn btn-outline-secondary export-btn" onclick="exportTemplate()">ğŸ“‹ å¯¼å…¥æ¨¡ç‰ˆ</button>
                                <button class="btn btn-outline-dark export-btn" onclick="document.getElementById('import-file').click()">ğŸ“‚ å¯¼å…¥æ•°æ®</button>
                                <input type="file" id="import-file" accept=".xlsx,.xls,.csv,.json" style="display: none;" onchange="importData(event)">
                            </div>
                        </div>
                    </div>

                    <!-- æ•°æ®è¡¨æ ¼ -->
                    <div class="card">
                        <div class="card-header">
                            <h4 class="mb-0">è°ƒç ”åˆ—è¡¨ <span class="badge bg-primary" id="total-count">0</span></h4>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover" id="research-table">
                                    <thead>
                                        <tr>
                                            <th>åºå·</th>
                                            <th>è°ƒç ”æ—¥æœŸ</th>
                                            <th>åŒè¡Œæ˜µç§°</th>
                                            <th>å¹³å°</th>
                                            <th>ä¸»è¦äº§å“</th>
                                            <th>ä»·æ ¼åŒºé—´</th>
                                            <th>ä¿¡ä»»åº¦</th>
                                            <th>å‚è€ƒä»·å€¼</th>
                                            <th>æ“ä½œ</th>
                                        </tr>
                                    </thead>
                                    <tbody id="research-tbody">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- åˆ†æé¡µé¢ -->
        <div id="analysis-page" class="tab-content" style="display: none;">
            <div class="row">
                <div class="col-12">
                    <!-- ç»Ÿè®¡æ¦‚è§ˆ -->
                    <div class="row mb-4">
                        <div class="col-md-3">
                            <div class="stats-card">
                                <div class="stats-number" id="stat-total">0</div>
                                <div>æ€»è°ƒç ”æ•°</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stats-card">
                                <div class="stats-number" id="stat-platforms">0</div>
                                <div>æ¶‰åŠå¹³å°</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stats-card">
                                <div class="stats-number" id="stat-high-trust">0</div>
                                <div>é«˜ä¿¡ä»»åº¦åŒè¡Œ</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stats-card">
                                <div class="stats-number" id="stat-high-value">0</div>
                                <div>é«˜ä»·å€¼åŒè¡Œ</div>
                            </div>
                        </div>
                    </div>

                    <!-- å¹³å°åˆ†å¸ƒ -->
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">å¹³å°åˆ†å¸ƒ</h5>
                                </div>
                                <div class="card-body">
                                    <canvas id="platform-chart" width="400" height="300"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">äº§å“ç±»å‹åˆ†å¸ƒ</h5>
                                </div>
                                <div class="card-body">
                                    <canvas id="product-type-chart" width="400" height="300"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- æ™ºèƒ½åˆ†æ -->
                    <div class="row mt-4">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">æ™ºèƒ½åˆ†æ</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="analysis-card">
                                                <h6>ğŸ¯ æˆåŠŸå¥—è·¯æ€»ç»“</h6>
                                                <div id="success-patterns">
                                                    <p class="text-muted">æš‚æ— æ•°æ®ï¼Œè¯·å…ˆæ·»åŠ è°ƒç ”è®°å½•</p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="analysis-card">
                                                <h6>âš ï¸ é£é™©æé†’</h6>
                                                <div id="risk-alerts">
                                                    <p class="text-muted">æš‚æ— æ•°æ®ï¼Œè¯·å…ˆæ·»åŠ è°ƒç ”è®°å½•</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mt-3">
                                        <div class="col-md-6">
                                            <div class="analysis-card">
                                                <h6>ğŸ’¡ æœºä¼šç‚¹åˆ†æ</h6>
                                                <div id="opportunities">
                                                    <p class="text-muted">æš‚æ— æ•°æ®ï¼Œè¯·å…ˆæ·»åŠ è°ƒç ”è®°å½•</p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="analysis-card">
                                                <h6>ğŸ“Š è¡ŒåŠ¨å»ºè®®</h6>
                                                <div id="recommendations">
                                                    <p class="text-muted">æš‚æ— æ•°æ®ï¼Œè¯·å…ˆæ·»åŠ è°ƒç ”è®°å½•</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- è¯¦æƒ…æ¨¡æ€æ¡† -->
    <div class="modal fade" id="detailModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">åŒè¡Œè¯¦æƒ…</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="modal-body">
                </div>
            </div>
        </div>
    </div>

    <!-- åˆ†ææŠ¥å‘Šæ¨¡æ€æ¡† -->
    <div class="modal fade" id="analysisModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">æ™ºèƒ½åˆ†ææŠ¥å‘Š</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="analysis-modal-body">
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/datatables.net@1.11.5/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/datatables.net-bs5@1.11.5/js/dataTables.bootstrap5.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    
    <script>
        // å…¨å±€å˜é‡
        let currentStep = 1;
        let researchData = JSON.parse(localStorage.getItem('researchData')) || [];
        let currentEditingId = null;

        // åˆå§‹åŒ–
        $(document).ready(function() {
            initApp();
            loadResearchData();
            updateAnalysis();
        });

        function initApp() {
            // è®¾ç½®æ—¥æœŸé»˜è®¤å€¼
            $('#research_date').val(new Date().toISOString().split('T')[0]);

            // æ ‡ç­¾é¡µåˆ‡æ¢
            $('.nav-link').click(function(e) {
                e.preventDefault();
                const tab = $(this).data('tab');
                switchTab(tab);
            });

            // å¹³å°é€‰æ‹© - åŸºç¡€ä¿¡æ¯é¡µé¢ï¼ˆä¸‹æ‹‰æ¡†å¤šé€‰ï¼‰
            $(document).on('change', '#research_platforms', function() {
                console.log('ä¸‹æ‹‰æ¡†é€‰æ‹©å˜åŒ–ï¼Œé€‰ä¸­çš„å€¼ï¼š', $('#research_platforms').val());
                generateTrafficPathFromOrder();
            });

          // å¹³å°é€‰æ‹© - æµé‡åˆ†æé¡µé¢ï¼ˆå¤šé€‰ï¼‰
            $(document).on('click', '.form-section[data-section="2"] .platform-chip', function() {
                $(this).toggleClass('selected');
            });

            // æµé‡å½¢å¼é€‰æ‹©
            $('input[type="checkbox"][id^="traffic_"]').change(function() {
                updateTrafficPath();
            });

            // æ­¥éª¤å¯¼èˆª
            $('#next-btn').click(function() {
                if (validateStep(currentStep)) {
                    if (currentStep < 4) {
                        showStep(currentStep + 1);
                    }
                }
            });

            $('#prev-btn').click(function() {
                if (currentStep > 1) {
                    showStep(currentStep - 1);
                }
            });

            // è¡¨å•æäº¤
            $('#research-form').submit(function(e) {
                e.preventDefault();
                submitForm();
            });

            // å¿«é€Ÿæäº¤æŒ‰é’®
            $('#quick-submit-btn').click(function() {
                if (confirm('ç¡®å®šè¦å¿«é€Ÿæäº¤å—ï¼Ÿå½“å‰å¡«å†™çš„å†…å®¹å°†è¢«ä¿å­˜ã€‚')) {
                    submitForm();
                }
            });

            // ç­›é€‰åŠŸèƒ½
            $('#filter-platform, #filter-price, #filter-trust').change(function() {
                filterData();
            });

            $('#search-input').keyup(function() {
                filterData();
            });

            // æµé‡è·¯å¾„ç±»å‹æ”¹å˜
            $('#traffic_path_type').change(function() {
                updateTrafficPath();
            });

            // è½¬åŒ–è·¯å¾„æ¨¡æ¿æ”¹å˜
            $('#conversion_path_template').change(function() {
                const template = $(this).val();
                if (template) {
                    const templatePaths = {
                        'å†…å®¹ç§è‰è·¯å¾„': 'å†…å®¹å¸å¼•â†’äº’åŠ¨å’¨è¯¢â†’ç§åŸŸè½¬åŒ–â†’æˆäº¤å¤è´­',
                        'ç›´æ’­è½¬åŒ–è·¯å¾„': 'ç›´æ’­å¼•æµâ†’é™æ—¶ä¼˜æƒ â†’ç«‹å³ä¸‹å•â†’å”®åç»´æŠ¤',
                        'æœç´¢ä¼˜åŒ–è·¯å¾„': 'æœç´¢æ’åâ†’ä¸»åŠ¨å’¨è¯¢â†’ä¸“ä¸šè§£ç­”â†’1v1æˆäº¤',
                        'ç¤¾ç¾¤è¿è¥è·¯å¾„': 'ç¤¾ç¾¤å¸å¼•â†’ä»·å€¼è¾“å‡ºâ†’ä¿¡ä»»å»ºç«‹â†’äº§å“è½¬åŒ–',
                        'å·¥å…·å¼•æµè·¯å¾„': 'å…è´¹å·¥å…·â†’ä½“éªŒäº§å“â†’ä»˜è´¹å‡çº§â†’æŒç»­æœåŠ¡',
                        'ç”µå•†å¼•æµè·¯å¾„': 'ä½ä»·äº§å“â†’ç§åŸŸæ²‰æ·€â†’åŸºç¡€äº¤ä»˜â†’ä¿¡ä»»å»ºç«‹â†’é«˜ä»·äº§å“â†’æŒç»­æœåŠ¡',
                        'çº¯ç”µå•†è·¯å¾„': 'å•†å“å±•ç¤ºâ†’å’¨è¯¢æ²Ÿé€šâ†’å¹³å°æˆäº¤â†’å‘è´§äº¤ä»˜â†’å”®åæœåŠ¡'
                    };
                    $('#conversion_path').val(templatePaths[template]);
                }
            });
        }

    
        function switchTab(tab) {
            $('.nav-link').removeClass('active');
            $(`.nav-link[data-tab="${tab}"]`).addClass('active');
            
            $('.tab-content').hide();
            $(`#${tab}-page`).show();
            
            if (tab === 'list') {
                updateTable();
            } else if (tab === 'analysis') {
                updateAnalysis();
            }
        }

        function showStep(step) {
            currentStep = step;
            $('.form-section').removeClass('active');
            $(`.form-section[data-section="${step}"]`).addClass('active');
            
            $('.step').removeClass('active');
            $(`.step[data-step="${step}"]`).addClass('active');
            
            if (step === 1) {
                $('#prev-btn').hide();
            } else {
                $('#prev-btn').show();
            }
            
            if (step === 4) {
                $('#next-btn').hide();
                $('#submit-btn').show();
            } else {
                $('#next-btn').show();
                $('#submit-btn').hide();
            }
        }

        function validateStep(step) {
            let isValid = true;
            
            if (step === 1) {
                if (!$('#research_date').val()) {
                    alert('è¯·é€‰æ‹©è°ƒç ”æ—¥æœŸ');
                    isValid = false;
                }
            }
            
            return isValid;
        }

        function updateTrafficPath() {
            const pathType = $('#traffic_path_type').val();
            const selectedTraffic = [];
            $('input[type="checkbox"][id^="traffic_"]:checked').each(function() {
                const label = $(this).next('label').text();
                selectedTraffic.push(label);
            });
            
            let pathDisplay = '';
            if (pathType) {
                switch(pathType) {
                    case 'å†…å®¹ç§è‰å‹':
                        pathDisplay = 'å†…å®¹ç§è‰ â†’ äº’åŠ¨å’¨è¯¢ â†’ ç§åŸŸè½¬åŒ–';
                        break;
                    case 'ç›´æ’­å¼•æµå‹':
                        pathDisplay = 'ç›´æ’­å¼•æµ â†’ é™æ—¶ä¼˜æƒ  â†’ ç«‹å³æˆäº¤';
                        break;
                    case 'æœç´¢ä¼˜åŒ–å‹':
                        pathDisplay = 'æœç´¢ä¼˜åŒ– â†’ ä¸»åŠ¨å’¨è¯¢ â†’ 1v1è½¬åŒ–';
                        break;
                    case 'ç¤¾ç¾¤è¿è¥å‹':
                        pathDisplay = 'ç¤¾ç¾¤è¿è¥ â†’ äº’åŠ¨ç»´æŠ¤ â†’ ç§åŸŸè½¬åŒ–';
                        break;
                    case 'å·¥å…·å¼•æµå‹':
                        pathDisplay = 'å·¥å…·å¼•æµ â†’ ä½“éªŒäº§å“ â†’ ä»˜è´¹å‡çº§';
                        break;
                    case 'ç”µå•†å¼•æµå‹':
                        pathDisplay = 'ç”µå•†å•†å“å¼•æµ â†’ æ·»åŠ ç§åŸŸ â†’ åŸºç¡€äº¤ä»˜ â†’ å»ºç«‹ä¿¡ä»» â†’ é«˜ä»·è½¬åŒ– â†’ æŒç»­å¤è´­';
                        break;
                    case 'çº¯ç”µå•†å‹':
                        pathDisplay = 'å•†å“å±•ç¤º â†’ å’¨è¯¢æ²Ÿé€š â†’ å¹³å°æˆäº¤ â†’ å‘è´§äº¤ä»˜ â†’ å”®åæœåŠ¡';
                        break;
                }
            }
            
            if (selectedTraffic.length > 0) {
                pathDisplay += `<br><small>å½¢å¼ç»„åˆï¼š${selectedTraffic.join(' + ')}</small>`;
            }
            
            if (pathDisplay) {
                $('#path-display').html(pathDisplay);
            } else {
                $('#path-display').html('<span class="text-muted">é€‰æ‹©æµé‡å½¢å¼åä¼šè‡ªåŠ¨ç”Ÿæˆè·¯å¾„</span>');
            }
        }

        function submitForm() {
            const formData = collectFormData();
            
            if (currentEditingId) {
                // ç¼–è¾‘æ¨¡å¼
                const index = researchData.findIndex(item => item.id === currentEditingId);
                researchData[index] = formData;
                currentEditingId = null;
            } else {
                // æ–°å¢æ¨¡å¼
                formData.id = Date.now();
                researchData.push(formData);
            }
            
            localStorage.setItem('researchData', JSON.stringify(researchData));
            
            // æ˜¾ç¤ºåˆ†æç»“æœ
            showAnalysisResult(formData);
            
            // é‡ç½®è¡¨å•
            resetForm();
            
            // åˆ‡æ¢åˆ°åˆ—è¡¨é¡µé¢
            switchTab('list');
        }

        function collectFormData() {
            // åŸºç¡€ä¿¡æ¯é¡µé¢çš„è°ƒç ”å¹³å°
            const selectedPlatforms = [];
            $('#research_platforms option:selected').each(function() {
                selectedPlatforms.push($(this).val());
            });
            
            // æµé‡åˆ†æé¡µé¢çš„ä¸»è¦æµé‡é˜µåœ°
            const mainPlatforms = [];
            $('.form-section[data-section="2"] .platform-chip.selected').each(function() {
                mainPlatforms.push($(this).data('platform'));
            });
            
            const trafficForms = [];
            $('input[type="checkbox"][id^="traffic_"]:checked').each(function() {
                trafficForms.push($(this).val());
            });
            
            const afterSalesServices = [];
            $('input[type="checkbox"][id^="after_sales_"]:checked').each(function() {
                afterSalesServices.push($(this).next('label').text());
            });
            
            const productTypes = [];
            $('input[type="checkbox"][id^="product_"]:checked').each(function() {
                productTypes.push($(this).val());
            });
            
            const monetizationMethods = [];
            $('input[type="checkbox"][id^="monetization_"]:checked').each(function() {
                monetizationMethods.push($(this).val());
            });
            
            const deliveryMethods = [];
            $('input[type="checkbox"][id^="delivery_"]:checked').each(function() {
                deliveryMethods.push($(this).val());
            });
            
            return {
                id: currentEditingId || Date.now(),
                research_date: $('#research_date').val(),
                peer_name: $('#peer_name').val(),
                platforms: selectedPlatforms,
                peer_description: $('#peer_description').val(),
                customer_type: $('#customer_type').val(),
                operation_entity: $('#operation_entity').val(),
                attraction_point: $('#attraction_point').val(),
                contact_method: $('#contact_method').val(),
                contact_added: $('#contact_added').val(),
                main_platforms: mainPlatforms,
                traffic_path_type: $('#traffic_path_type').val(),
                traffic_forms: trafficForms,
                custom_path: $('#custom_path').val(),
                content_frequency: $('#content_frequency').val(),
                interaction_level: $('#interaction_level').val(),
                product_main: $('#product_main').val(),
                product_types: productTypes,
                monetization_methods: monetizationMethods,
                product_entry: $('#product_entry').val(),
                price_entry: $('#price_entry').val(),
                delivery_method_entry: $('#delivery_method_entry').val(),
                delivery_period_entry: $('#delivery_period_entry').val(),
                product_mid: $('#product_mid').val(),
                price_mid: $('#price_mid').val(),
                delivery_method_mid: $('#delivery_method_mid').val(),
                delivery_period_mid: $('#delivery_period_mid').val(),
                product_high: $('#product_high').val(),
                price_high: $('#price_high').val(),
                delivery_method_high: $('#delivery_method_high').val(),
                delivery_period_high: $('#delivery_period_high').val(),
                delivery_location: $('#delivery_location').val(),
                delivery_methods: deliveryMethods,
                product_selling_point: $('#product_selling_point').val(),
                pricing_strategy: $('#pricing_strategy').val(),
                promotion_info: $('#promotion_info').val(),
                seen_acquisition_channel: $('#seen_acquisition_channel').val(),
                conversion_path: $('#conversion_path').val(),
                customer_maintenance: $('#customer_maintenance').val(),
                after_sales_services: afterSalesServices,
                after_sales_content: $('#after_sales_content').val(),
                customer_maintenance_strategy: $('#customer_maintenance_strategy').val(),
                repurchase_strategy: $('#repurchase_strategy').val(),
                revenue_estimate: $('#revenue_estimate').val(),
                trust_score: $('#trust_score').val(),
                reference_value: $('#reference_value').val(),
                learning_points: $('#learning_points').val(),
                improvement_points: $('#improvement_points').val(),
                traffic_path: $('#generated_path').text(),
                created_at: new Date().toISOString()
            };
        }

        function resetForm() {
            $('#research-form')[0].reset();
            $('#research_date').val(new Date().toISOString().split('T')[0]);
            $('#research_platforms option:selected').prop('selected', false); // é‡ç½®ä¸‹æ‹‰æ¡†é€‰æ‹©
            $('.platform-chip').removeClass('selected');
            $('.custom-platform-chip').remove(); // æ¸…ç†è‡ªå®šä¹‰å¹³å°
            $('input[type="checkbox"][id^="traffic_"]').prop('checked', false);
            $('#product_types option').prop('selected', false);
            $('#monetization_types option').prop('selected', false);
            userSelectedPlatforms = []; // é‡ç½®ç”¨æˆ·é€‰æ‹©é¡ºåº
            generateTrafficPathFromOrder(); // é‡ç½®åé‡æ–°ç”Ÿæˆè·¯å¾„
            $('#delivery_methods option').prop('selected', false);
            currentStep = 1;
            showStep(1);
            currentEditingId = null;
        }

        function showAnalysisResult(data) {
            const analysis = generateAnalysis(data);
            
            let modalContent = `
                <div class="row">
                    <div class="col-md-6">
                        <div class="text-center mb-3">
                            <div class="score-circle" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                                ${analysis.overallScore}
                            </div>
                            <h6>ç»¼åˆè¯„åˆ†</h6>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <h5>ğŸ¯ å¥—è·¯åˆ†æ</h5>
                        <p><strong>æµé‡å¥åº·åº¦ï¼š</strong>${analysis.trafficHealth}/10</p>
                        <p><strong>äº§å“æ¶æ„ï¼š</strong>${analysis.productStructure}/10</p>
                        <p><strong>è¿è¥æˆç†Ÿåº¦ï¼š</strong>${analysis.operationMaturity}/10</p>
                        <p><strong>å¯å¤åˆ¶æ€§ï¼š</strong>${analysis.replicability}/10</p>
                    </div>
                </div>
                <hr>
                <div class="row">
                    <div class="col-12">
                        <h5>ğŸ’¡ æ ¸å¿ƒå‘ç°</h5>
                        <ul>
                            ${analysis.findings.map(f => `<li>${f}</li>`).join('')}
                        </ul>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <h5>ğŸŒŸ æœºä¼šç‚¹</h5>
                        <ul>
                            ${analysis.opportunities.map(o => `<li>${o}</li>`).join('')}
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <h5>âš ï¸ é£é™©æç¤º</h5>
                        <ul>
                            ${analysis.risks.map(r => `<li>${r}</li>`).join('')}
                        </ul>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12">
                        <h5>ğŸ“ è¡ŒåŠ¨å»ºè®®</h5>
                        <ol>
                            ${analysis.recommendations.map(r => `<li>${r}</li>`).join('')}
                        </ol>
                    </div>
                </div>
            `;
            
            $('#analysis-modal-body').html(modalContent);
            const modal = new bootstrap.Modal(document.getElementById('analysisModal'));
            modal.show();
        }

        function generateAnalysis(data) {
            let overallScore = 0;
            let trafficHealth = 5;
            let productStructure = 5;
            let operationMaturity = 5;
            let marketPotential = 5;
            
            // æµé‡å¥åº·åº¦è¯„ä¼° - ä»æµé‡æ€ç»´è§’åº¦
            if (data.traffic_forms && data.traffic_forms.length > 2) {
                trafficHealth += 2;
            }
            if (data.content_frequency === 'æ—¥æ›´' || data.content_frequency === 'å‘¨æ›´2-3æ¬¡') {
                trafficHealth += 2;
            }
            if (data.interaction_level === 'å¾ˆé«˜' || data.interaction_level === 'è¾ƒé«˜') {
                trafficHealth += 1;
            }
            
            // äº§å“æ¶æ„è¯„ä¼° - ä»äº§å“æ€ç»´è§’åº¦  
            const productLevels = [data.product_entry, data.product_mid, data.product_high].filter(Boolean).length;
            if (productLevels >= 2) {
                productStructure += 3;
            }
            if (data.pricing_strategy === 'åˆ†å±‚å®šä»·') {
                productStructure += 2;
            }
            const deliveryMethods = [data.delivery_method_entry, data.delivery_method_mid, data.delivery_method_high].filter(Boolean).length;
            if (deliveryMethods > 0) {
                productStructure += 1;
            }
            
            // è¿è¥æˆç†Ÿåº¦è¯„ä¼° - ä»è¿è¥æ€ç»´è§’åº¦
            if (data.seen_acquisition_channel && data.conversion_path) {
                operationMaturity += 2;
            }
            if (data.customer_maintenance && data.repurchase_strategy) {
                operationMaturity += 2;
            }
            if (data.trust_score && (data.trust_score.includes('4') || data.trust_score.includes('5'))) {
                operationMaturity += 1;
            }
            
            // å¸‚åœºæ½œåŠ›è¯„ä¼° - å•†ä¸šä»·å€¼åˆ†æ
            if (data.revenue_estimate && (data.revenue_estimate.includes('æœˆå…¥1-3ä¸‡') || data.revenue_estimate.includes('æœˆå…¥3ä¸‡ä»¥ä¸Š'))) {
                marketPotential += 3;
            }
            if (data.after_sales_services && data.after_sales_services.length > 2) {
                marketPotential += 2;
            }
            if (data.learning_points && data.learning_points.length > 50) {
                marketPotential += 1;
            }
            
            overallScore = Math.round((trafficHealth + productStructure + operationMaturity + marketPotential) / 4);
            
            // ç”Ÿæˆåˆ†æç»“æœ
            const findings = [];
            const opportunities = [];
            const risks = [];
            const recommendations = [];
            
            // æµé‡æ€ç»´åˆ†æ
            if (data.traffic_path_type === 'å†…å®¹ç§è‰å‹') {
                findings.push('æµé‡ç­–ç•¥ï¼šé‡‡ç”¨å†…å®¹ç§è‰æ¨¡å¼ï¼Œé€šè¿‡æŒç»­ä¼˜è´¨å†…å®¹å»ºç«‹é•¿æœŸæµé‡æ± ');
                opportunities.push('å¯å€Ÿé‰´ç‚¹ï¼šå†…å®¹èµ„äº§å…·æœ‰ç´¯ç§¯æ•ˆåº”ï¼Œå¯å½¢æˆç¨³å®šçš„è¢«åŠ¨æµé‡æ¥æº');
                recommendations.push('å·®å¼‚åŒ–æ€è·¯ï¼šåœ¨åŒä¸€èµ›é“ä¸­å¯»æ‰¾ç»†åˆ†å†…å®¹é¢†åŸŸï¼Œé¿å…ç›´æ¥ç«äº‰');
            } else if (data.traffic_path_type === 'ç›´æ’­å¼•æµå‹') {
                findings.push('æµé‡ç­–ç•¥ï¼šé‡‡ç”¨ç›´æ’­å¼•æµæ¨¡å¼ï¼Œé€šè¿‡å®æ—¶äº’åŠ¨æé«˜è½¬åŒ–æ•ˆç‡');
                risks.push('é£é™©ç‚¹ï¼šå¯¹ä¸»æ’­ä¸ªäººèƒ½åŠ›ä¾èµ–æ€§å¼ºï¼Œè§„æ¨¡åŒ–éš¾åº¦å¤§');
                recommendations.push('å¯å€Ÿé‰´ç‚¹ï¼šå­¦ä¹ å…¶ç›´æ’­é—´è½¬åŒ–è¯æœ¯å’Œäº’åŠ¨èŠ‚å¥è®¾è®¡');
            } else if (data.traffic_path_type === 'ç”µå•†å¼•æµå‹') {
                findings.push('æµé‡ç­–ç•¥ï¼šé‡‡ç”¨ç”µå•†å¼•æµæ¨¡å¼ï¼Œé€šè¿‡äº§å“å±•ç¤ºä¿ƒè¿›ç›´æ¥è½¬åŒ–');
                opportunities.push('å¯å€Ÿé‰´ç‚¹ï¼šäº§å“é¡µé¢çš„è§†è§‰è®¾è®¡å’Œå–ç‚¹æç‚¼å€¼å¾—å­¦ä¹ ');
                recommendations.push('å·®å¼‚åŒ–æ€è·¯ï¼šåœ¨åŒç±»äº§å“ä¸­å¼ºåŒ–æœåŠ¡å·®å¼‚åŒ–ï¼Œé¿å…çº¯ä»·æ ¼ç«äº‰');
            }
            
            // äº§å“æ€ç»´åˆ†æ
            if (productLevels >= 2) {
                findings.push('äº§å“ç­–ç•¥ï¼šé‡‡ç”¨å¤šå±‚çº§äº§å“æ¶æ„ï¼Œè¦†ç›–ä¸åŒæ¶ˆè´¹èƒ½åŠ›å®¢ç¾¤');
                opportunities.push('å¯å€Ÿé‰´ç‚¹ï¼šä½é—¨æ§›å¼•æµäº§å“+é«˜åˆ©æ¶¦æ ¸å¿ƒäº§å“çš„ç»„åˆæ¨¡å¼');
                recommendations.push('å·®å¼‚åŒ–æ€è·¯ï¼šåœ¨æŸä¸ªä»·æ ¼å¸¦æˆ–äº§å“å½¢æ€ä¸Šåšæ·±åº¦ï¼Œå½¢æˆå±€éƒ¨ä¼˜åŠ¿');
            }
            
            // äº§å“ç±»å‹åˆ†æ
            if (data.product_types && data.product_types.length > 0) {
                const hasHighEnd = data.product_types.includes('é«˜å®¢å•å®šåˆ¶');
                const hasDigital = data.product_types.includes('è™šæ‹Ÿäº§å“') || data.product_types.includes('çŸ¥è¯†ä»˜è´¹') || data.product_types.includes('è½¯ä»¶å·¥å…·');
                const hasService = data.product_types.includes('æœåŠ¡ç±»');
                
                if (hasHighEnd) {
                    findings.push('äº§å“ç­–ç•¥ï¼šåŒ…å«é«˜å®¢å•å®šåˆ¶ä¸šåŠ¡ï¼Œå…·å¤‡æ·±åº¦æœåŠ¡èƒ½åŠ›');
                    opportunities.push('å¯å€Ÿé‰´ç‚¹ï¼šé«˜å®¢å•å®¢æˆ·çš„è·å–å’ŒæœåŠ¡æ¨¡å¼');
                    recommendations.push('å·®å¼‚åŒ–æ€è·¯ï¼šåœ¨ç‰¹å®šç»†åˆ†é¢†åŸŸå»ºç«‹ä¸“å®¶åœ°ä½ï¼Œæ”¯æ’‘é«˜å®¢å•å®šä»·');
                }
                
                if (hasDigital) {
                    findings.push('äº§å“ç­–ç•¥ï¼šä»¥æ•°å­—åŒ–äº§å“ä¸ºä¸»ï¼Œè¾¹é™…æˆæœ¬ä½ï¼Œæ˜“äºè§„æ¨¡åŒ–');
                    opportunities.push('å¯å€Ÿé‰´ç‚¹ï¼šæ•°å­—åŒ–äº§å“çš„æ ‡å‡†åŒ–å’Œè‡ªåŠ¨åŒ–äº¤ä»˜');
                    recommendations.push('å·®å¼‚åŒ–æ€è·¯ï¼šåœ¨å†…å®¹è´¨é‡æˆ–ç”¨æˆ·ä½“éªŒä¸Šå»ºç«‹å·®å¼‚åŒ–');
                }
                
                if (hasService) {
                    findings.push('äº§å“ç­–ç•¥ï¼šæä¾›äººå·¥æœåŠ¡ï¼Œå®¢æˆ·ç²˜æ€§è¾ƒé«˜');
                    opportunities.push('å¯å€Ÿé‰´ç‚¹ï¼šæœåŠ¡æµç¨‹è®¾è®¡å’Œè´¨é‡æ§åˆ¶');
                    recommendations.push('å·®å¼‚åŒ–æ€è·¯ï¼šåœ¨æœåŠ¡å“åº”é€Ÿåº¦æˆ–ä¸“ä¸šæ€§ä¸Šå»ºç«‹ä¼˜åŠ¿');
                }
                
                if (data.product_types.length > 2) {
                    findings.push('äº§å“ç­–ç•¥ï¼šäº§å“ç±»å‹å¤šå…ƒåŒ–ï¼Œä¸šåŠ¡æ¨¡å¼ä¸°å¯Œ');
                    risks.push('é£é™©ç‚¹ï¼šäº§å“çº¿è¿‡å¤šå¯èƒ½å¯¼è‡´èµ„æºåˆ†æ•£');
                    recommendations.push('å¯å€Ÿé‰´ç‚¹ï¼šä¸åŒäº§å“ç±»å‹ä¹‹é—´çš„ååŒæ•ˆåº”');
                }
            }
            
            if (deliveryMethods > 1) {
                findings.push('äº¤ä»˜ç­–ç•¥ï¼šçµæ´»çš„äº¤ä»˜æ–¹å¼ç»„åˆï¼Œæé«˜å®¢æˆ·è´­ä¹°ä¾¿åˆ©æ€§');
                opportunities.push('å¯å€Ÿé‰´ç‚¹ï¼šçº¿ä¸Šäº¤ä»˜é™ä½æˆæœ¬ï¼Œçº¿ä¸‹äº¤ä»˜æå‡ä½“éªŒçš„ç»„åˆç­–ç•¥');
            }
            
            // è¿è¥æ€ç»´åˆ†æ
            if (data.seen_acquisition_channel && data.conversion_path) {
                findings.push('è¿è¥ç­–ç•¥ï¼šä»è·å®¢åˆ°è½¬åŒ–çš„å®Œæ•´è·¯å¾„è®¾è®¡ï¼Œè¿è¥æ€è·¯æ¸…æ™°');
                recommendations.push('å¯å€Ÿé‰´ç‚¹ï¼šé‡ç‚¹å…³æ³¨å…¶è½¬åŒ–è·¯å¾„ä¸­çš„å…³é”®èŠ‚ç‚¹è®¾è®¡');
            }
            
            if (data.after_sales_services && data.after_sales_services.length > 0) {
                findings.push('è¿è¥ç­–ç•¥ï¼šé‡è§†å”®åæœåŠ¡ä½“ç³»ï¼Œæé«˜å®¢æˆ·å¤è´­ç‡å’Œå£ç¢‘ä¼ æ’­');
                opportunities.push('å¯å€Ÿé‰´ç‚¹ï¼šå”®åæœåŠ¡ä¸ä»…æ˜¯æˆæœ¬ä¸­å¿ƒï¼Œæ›´æ˜¯åˆ©æ¶¦å¢é•¿ç‚¹');
            }
            
            if (data.trust_score && (data.trust_score.includes('4') || data.trust_score.includes('5'))) {
                findings.push('å“ç‰Œå»ºè®¾ï¼šä¸ªäººå“ç‰Œæˆ–äº§å“ä¿¡ä»»åº¦è¾ƒé«˜ï¼Œå…·æœ‰æº¢ä»·èƒ½åŠ›');
                opportunities.push('å¯å€Ÿé‰´ç‚¹ï¼šä¿¡ä»»åº¦å»ºè®¾çš„æ–¹æ³•å’ŒèŠ‚å¥å€¼å¾—å­¦ä¹ ');
                recommendations.push('å·®å¼‚åŒ–æ€è·¯ï¼šåœ¨ä¸“ä¸šåº¦ã€æœåŠ¡æ€åº¦æˆ–å“åº”é€Ÿåº¦ä¸Šå»ºç«‹å·®å¼‚åŒ–ä¿¡ä»»');
            }
            
            // å•†ä¸šä»·å€¼åˆ†æ
            if (data.revenue_estimate && data.revenue_estimate.includes('æœˆå…¥1-3ä¸‡')) {
                findings.push('å•†ä¸šè¡¨ç°ï¼šè¥æ”¶è¾¾åˆ°ç¨³å®šæ°´å¹³ï¼Œå•†ä¸šæ¨¡å¼å·²å¾—åˆ°éªŒè¯');
                recommendations.push('é‡ç‚¹å…³æ³¨ï¼šå…¶è·å®¢æˆæœ¬å’Œå®¢æˆ·ç”Ÿå‘½å‘¨æœŸçš„å¹³è¡¡ç­–ç•¥');
            } else if (data.revenue_estimate && data.revenue_estimate.includes('æœˆå…¥3ä¸‡ä»¥ä¸Š')) {
                findings.push('å•†ä¸šè¡¨ç°ï¼šè¥æ”¶è¡¨ç°ä¼˜ç§€ï¼Œå·²å…·å¤‡è§„æ¨¡åŒ–åŸºç¡€');
                opportunities.push('å¯å€Ÿé‰´ç‚¹ï¼šå›¢é˜Ÿåä½œå’Œæµç¨‹æ ‡å‡†åŒ–çš„ç»éªŒ');
                risks.push('é£é™©ç‚¹ï¼šå¯èƒ½é¢ä¸´æ›´å¤§ç«äº‰å‹åŠ›å’Œæ¨¡ä»¿è€…æŒ‘æˆ˜');
            }
            
            // å®¢è§‚åˆ†æå’Œè¡ŒåŠ¨å»ºè®®
            if (trafficHealth >= 8) {
                findings.push('æµé‡ä¼˜åŠ¿ï¼šåœ¨æµé‡è·å–å’Œç»´æŠ¤æ–¹é¢è¡¨ç°çªå‡º');
                recommendations.push('è¡ŒåŠ¨å»ºè®®ï¼šåˆ†æå…¶æµé‡æ¥æºæ„æˆï¼Œå¯»æ‰¾å¯å¤åˆ¶çš„æµé‡æ¸ é“');
            }
            
            if (productStructure >= 8) {
                findings.push('äº§å“ä¼˜åŠ¿ï¼šäº§å“è®¾è®¡å’Œå®šä»·ç­–ç•¥æˆç†Ÿ');
                recommendations.push('è¡ŒåŠ¨å»ºè®®ï¼šå­¦ä¹ å…¶äº§å“è¿­ä»£èŠ‚å¥å’Œå®¢æˆ·åé¦ˆæœºåˆ¶');
            }
            
            if (operationMaturity >= 8) {
                findings.push('è¿è¥ä¼˜åŠ¿ï¼šè¿è¥ä½“ç³»å®Œæ•´ï¼Œå®¢æˆ·ç®¡ç†è§„èŒƒ');
                recommendations.push('è¡ŒåŠ¨å»ºè®®ï¼šé‡ç‚¹å…³æ³¨å…¶å®¢æˆ·åˆ†å±‚è¿è¥ç­–ç•¥');
            }
            
            // é’ˆå¯¹ä¸åŒèµ›é“çš„å·®å¼‚åŒ–å»ºè®®
            if (data.main_platforms && data.main_platforms.includes('å°çº¢ä¹¦')) {
                recommendations.push('å°çº¢ä¹¦å·®å¼‚åŒ–ï¼šé‡è§†ç¬”è®°è´¨é‡å’Œè§†è§‰å‘ˆç°ï¼Œå»ºç«‹ä¸“ä¸šäººè®¾');
            }
            if (data.main_platforms && data.main_platforms.includes('æŠ–éŸ³')) {
                recommendations.push('æŠ–éŸ³å·®å¼‚åŒ–ï¼šåœ¨çŸ­è§†é¢‘å†…å®¹å½¢å¼æˆ–ç›´æ’­é£æ ¼ä¸Šå¯»æ‰¾ç‹¬ç‰¹æ€§');
            }
            if (data.main_platforms && data.main_platforms.includes('çŸ¥ä¹')) {
                recommendations.push('çŸ¥ä¹å·®å¼‚åŒ–ï¼šåœ¨ä¸“ä¸šæ·±åº¦å’Œé€»è¾‘æ€§ä¸Šå»ºç«‹ç«äº‰å£å’');
            }
            
            // é’ˆå¯¹å®¢æˆ·ç¾¤ç±»å‹çš„åˆ†æ
            if (data.customer_type === 'To C') {
                findings.push('å®¢æˆ·ç¾¤ä½“ï¼šé¢å‘ä¸ªäººæ¶ˆè´¹è€…ï¼Œæ³¨é‡äº§å“ä½“éªŒå’Œæƒ…æ„Ÿè¿æ¥');
                opportunities.push('å¯å€Ÿé‰´ç‚¹ï¼šä¸ªäººæ¶ˆè´¹è€…çš„å¤è´­ç‡å’Œå£ç¢‘ä¼ æ’­æœºåˆ¶');
                recommendations.push('å·®å¼‚åŒ–æ€è·¯ï¼šåœ¨æœåŠ¡ä¸ªæ€§åŒ–æˆ–å“åº”é€Ÿåº¦ä¸Šå»ºç«‹ä¼˜åŠ¿');
            } else if (data.customer_type === 'To B') {
                findings.push('å®¢æˆ·ç¾¤ä½“ï¼šé¢å‘ä¼ä¸šå®¢æˆ·ï¼Œæ³¨é‡ä¸“ä¸šæ€§å’Œè§£å†³æ–¹æ¡ˆèƒ½åŠ›');
                opportunities.push('å¯å€Ÿé‰´ç‚¹ï¼šä¼ä¸šå®¢æˆ·çš„é•¿æœŸåˆä½œæ¨¡å¼å’Œä¿¡ä»»å»ºç«‹æ–¹å¼');
                recommendations.push('å·®å¼‚åŒ–æ€è·¯ï¼šåœ¨å‚ç›´è¡Œä¸šçš„ä¸“ä¸šæ·±åº¦æˆ–å®šåˆ¶åŒ–èƒ½åŠ›ä¸Šåšæ–‡ç« ');
            } else if (data.customer_type === 'ä¸¤è€…éƒ½æœ‰') {
                findings.push('å®¢æˆ·ç¾¤ä½“ï¼šåŒæ—¶æœåŠ¡ä¸ªäººå’Œä¼ä¸šå®¢æˆ·ï¼Œä¸šåŠ¡æ¨¡å¼å¤šå…ƒåŒ–');
                opportunities.push('å¯å€Ÿé‰´ç‚¹ï¼šä¸åŒå®¢æˆ·ç¾¤ä½“çš„äº§å“è®¾è®¡å’Œå®šä»·ç­–ç•¥');
                risks.push('é£é™©ç‚¹ï¼šèµ„æºåˆ†æ•£ï¼Œå¯èƒ½éš¾ä»¥åœ¨æŸä¸ªé¢†åŸŸåšåˆ°æè‡´');
                recommendations.push('å·®å¼‚åŒ–æ€è·¯ï¼šé€‰æ‹©ä¸€ä¸ªæ ¸å¿ƒå®¢æˆ·ç¾¤æ·±è€•ï¼Œå…¶ä»–ä½œä¸ºè¡¥å……');
            }
            
            // è¿è¥ä¸»ä½“åˆ†æ
            if (data.operation_entity) {
                if (data.operation_entity === 'ä¸ªäºº') {
                    findings.push('è¿è¥æ¨¡å¼ï¼šä¸ªäººè¿è¥ï¼Œçµæ´»æ€§å¼ºï¼Œæˆæœ¬ä½');
                    opportunities.push('å¯å€Ÿé‰´ç‚¹ï¼šä¸ªäººå“ç‰Œæ‰“é€ å’Œæ—¶é—´ç®¡ç†æ–¹æ³•');
                    risks.push('é£é™©ç‚¹ï¼šè§„æ¨¡åŒ–éš¾åº¦å¤§ï¼Œä¸ªäººæ—¶é—´ç²¾åŠ›æœ‰é™');
                    recommendations.push('å·®å¼‚åŒ–æ€è·¯ï¼šåœ¨ä¸“ä¸šæ·±åº¦å’Œä¸ªäººç‰¹è‰²ä¸Šå»ºç«‹ä¼˜åŠ¿');
                } else if (data.operation_entity === 'å°å›¢é˜Ÿ') {
                    findings.push('è¿è¥æ¨¡å¼ï¼šå°å›¢é˜Ÿè¿è¥ï¼Œå…·å¤‡ä¸€å®šåˆ†å·¥å’Œåä½œèƒ½åŠ›');
                    opportunities.push('å¯å€Ÿé‰´ç‚¹ï¼šå°å›¢é˜Ÿçš„æ•ˆç‡ç®¡ç†å’Œè§’è‰²åˆ†é…');
                    recommendations.push('å·®å¼‚åŒ–æ€è·¯ï¼šåœ¨å›¢é˜Ÿä¸“ä¸šç»„åˆå’ŒæœåŠ¡å“åº”é€Ÿåº¦ä¸Šå»ºç«‹ä¼˜åŠ¿');
                } else if (data.operation_entity === 'ä¸­å‹å›¢é˜Ÿ' || data.operation_entity === 'å¤§å›¢é˜Ÿ') {
                    findings.push('è¿è¥æ¨¡å¼ï¼šä¸­å¤§å‹å›¢é˜Ÿè¿è¥ï¼Œä½“ç³»åŒ–ç¨‹åº¦é«˜');
                    opportunities.push('å¯å€Ÿé‰´ç‚¹ï¼šå›¢é˜Ÿç®¡ç†å’Œæµç¨‹æ ‡å‡†åŒ–ç»éªŒ');
                    risks.push('é£é™©ç‚¹ï¼šç®¡ç†æˆæœ¬é«˜ï¼Œå†³ç­–é“¾æ¡é•¿');
                    recommendations.push('å·®å¼‚åŒ–æ€è·¯ï¼šåœ¨èµ„æºæ•´åˆå’ŒæœåŠ¡è´¨é‡ä¸Šå»ºç«‹ä¼˜åŠ¿');
                } else if (data.operation_entity === 'å…¬å¸') {
                    findings.push('è¿è¥æ¨¡å¼ï¼šå…¬å¸åŒ–è¿è¥ï¼Œè§„èŒƒåŒ–å’Œè§„æ¨¡åŒ–ç¨‹åº¦é«˜');
                    opportunities.push('å¯å€Ÿé‰´ç‚¹ï¼šä¼ä¸šç®¡ç†å’Œå¸‚åœºæ‹“å±•ç­–ç•¥');
                    recommendations.push('å·®å¼‚åŒ–æ€è·¯ï¼šåœ¨å“ç‰Œå®åŠ›å’ŒæœåŠ¡ä½“ç³»ä¸Šå»ºç«‹ä¼˜åŠ¿');
                }
            }
            
            // å˜ç°å½¢å¼åˆ†æ
            if (data.monetization_methods && data.monetization_methods.length > 0) {
                const hasDirect = data.monetization_methods.includes('ç›´é”€');
                const hasDistribution = data.monetization_methods.includes('åˆ†é”€');
                const hasMembership = data.monetization_methods.includes('ä¼šå‘˜è®¢é˜…');
                const hasAffiliate = data.monetization_methods.includes('è”ç›Ÿè¥é”€');
                
                if (hasDirect) {
                    findings.push('å˜ç°ç­–ç•¥ï¼šä»¥ç›´é”€ä¸ºä¸»ï¼Œåˆ©æ¶¦ç©ºé—´è¾ƒå¤§ï¼Œå®¢æˆ·å…³ç³»ç›´æ¥');
                    opportunities.push('å¯å€Ÿé‰´ç‚¹ï¼šç›´é”€çš„å®¢æˆ·è·å–æˆæœ¬æ§åˆ¶å’Œè½¬åŒ–æµç¨‹ä¼˜åŒ–');
                }
                
                if (hasDistribution) {
                    findings.push('å˜ç°ç­–ç•¥ï¼šé‡‡ç”¨åˆ†é”€æ¨¡å¼ï¼Œå…·å¤‡è§„æ¨¡åŒ–æ‰©å¼ æ½œåŠ›');
                    opportunities.push('å¯å€Ÿé‰´ç‚¹ï¼šåˆ†é”€ä½“ç³»çš„è®¾è®¡å’Œä»£ç†ç®¡ç†æœºåˆ¶');
                    risks.push('é£é™©ç‚¹ï¼šåˆ†é”€æ¨¡å¼å¯èƒ½å½±å“å“ç‰Œæ§åˆ¶å’Œå®¢æˆ·ä½“éªŒ');
                    recommendations.push('å·®å¼‚åŒ–æ€è·¯ï¼šåœ¨äº§å“è´¨é‡æˆ–æœåŠ¡æ”¯æŒä¸Šå»ºç«‹ä¼˜åŠ¿');
                }
                
                if (hasMembership) {
                    findings.push('å˜ç°ç­–ç•¥ï¼šä¼šå‘˜è®¢é˜…æ¨¡å¼ï¼Œå…·å¤‡ç¨³å®šçš„ç°é‡‘æµ');
                    opportunities.push('å¯å€Ÿé‰´ç‚¹ï¼šä¼šå‘˜æƒç›Šè®¾è®¡å’Œç»­è´¹ç‡æå‡ç­–ç•¥');
                    recommendations.push('å·®å¼‚åŒ–æ€è·¯ï¼šåœ¨ä¼šå‘˜ä¸“å±å†…å®¹æˆ–æœåŠ¡ä¸Šåšæ·±åº¦');
                }
                
                if (hasAffiliate) {
                    findings.push('å˜ç°ç­–ç•¥ï¼šè”ç›Ÿè¥é”€æ¨¡å¼ï¼Œè¾ƒä½çš„è·å®¢é£é™©');
                    opportunities.push('å¯å€Ÿé‰´ç‚¹ï¼šè”ç›Ÿä¼™ä¼´çš„é€‰æ‹©å’Œä½£é‡‘ç»“æ„è®¾è®¡');
                    recommendations.push('å·®å¼‚åŒ–æ€è·¯ï¼šåœ¨è½¬åŒ–æ¼æ–—å’Œè¥é”€ç´ æä¸Šä¼˜åŒ–');
                }
                
                if (data.monetization_methods.length > 2) {
                    findings.push('å˜ç°ç­–ç•¥ï¼šå˜ç°æ¸ é“å¤šå…ƒåŒ–ï¼Œæ”¶å…¥ç»“æ„ç¨³å®š');
                    opportunities.push('å¯å€Ÿé‰´ç‚¹ï¼šä¸åŒå˜ç°æ–¹å¼çš„ååŒæ•ˆåº”');
                    risks.push('é£é™©ç‚¹ï¼šç®¡ç†å¤æ‚åº¦å¢åŠ ï¼Œå¯èƒ½åˆ†æ•£ç²¾åŠ›');
                    recommendations.push('å¯å€Ÿé‰´ç‚¹ï¼šèµ„æºåˆ†é…å’Œä¼˜å…ˆçº§ç®¡ç†ç»éªŒ');
                }
            }
            
            // çŸ¥è¯†æ˜Ÿçƒå¼•æµåˆ†æ
            if (data.traffic_forms && data.traffic_forms.includes('ğŸª çŸ¥è¯†æ˜Ÿçƒå¼•æµ')) {
                findings.push('æµé‡ç­–ç•¥ï¼šé‡‡ç”¨çŸ¥è¯†æ˜Ÿçƒå¼•æµæ¨¡å¼ï¼Œé€‚åˆçŸ¥è¯†ä»˜è´¹å’Œç¤¾ç¾¤è¿è¥');
                opportunities.push('å¯å€Ÿé‰´ç‚¹ï¼šç¤¾ç¾¤è¿è¥å’ŒçŸ¥è¯†æ²‰æ·€çš„æ–¹æ³•');
                recommendations.push('å·®å¼‚åŒ–æ€è·¯ï¼šåœ¨å†…å®¹è´¨é‡æˆ–äº’åŠ¨æ°›å›´ä¸Šå»ºç«‹ç‰¹è‰²');
            }
            
            return {
                overallScore,
                trafficHealth,
                productStructure,
                operationMaturity,
                marketPotential,
                findings,
                opportunities,
                risks,
                recommendations
            };
        }

        function loadResearchData() {
            updateTable();
            updateStats();
        }

        function updateTable() {
            const tbody = $('#research-tbody');
            tbody.empty();
            
            let filteredData = filterData();
            
            filteredData.forEach((item, index) => {
                const trustStars = item.trust_score ? item.trust_score.split('-')[0] : '0';
                const row = `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${item.research_date}</td>
                        <td>${item.peer_name || 'æœªå¡«å†™'}</td>
                        <td>${item.platforms ? item.platforms.join(', ') : ''}</td>
                        <td>${item.product_main || 'æœªå¡«å†™'}</td>
                        <td>${getPriceRange(item)}</td>
                        <td>${trustStars}æ˜Ÿ</td>
                        <td>${item.reference_value || 'æœªè¯„ä¼°'}</td>
                        <td>
                            <button class="btn btn-sm btn-outline-primary" onclick="viewDetail(${item.id})">æŸ¥çœ‹</button>
                            <button class="btn btn-sm btn-outline-secondary" onclick="editItem(${item.id})">ç¼–è¾‘</button>
                            <button class="btn btn-sm btn-outline-danger" onclick="deleteItem(${item.id})">åˆ é™¤</button>
                        </td>
                    </tr>
                `;
                tbody.append(row);
            });
            
            $('#total-count').text(filteredData.length);
        }

        function getPriceRange(item) {
            const prices = [item.price_entry, item.price_mid, item.price_high].filter(Boolean);
            if (prices.length === 0) return 'æœªå¡«å†™';
            
            const numPrices = prices.map(p => parseInt(p.replace(/[^0-9]/g, '')) || 0);
            const min = Math.min(...numPrices);
            const max = Math.max(...numPrices);
            
            return min === max ? `${min}å…ƒ` : `${min}-${max}å…ƒ`;
        }

        function filterData() {
            let filtered = [...researchData];
            
            const platformFilter = $('#filter-platform').val();
            const priceFilter = $('#filter-price').val();
            const trustFilter = $('#filter-trust').val();
            const searchTerm = $('#search-input').val().toLowerCase();
            
            if (platformFilter) {
                filtered = filtered.filter(item => item.platforms && item.platforms.includes(platformFilter));
            }
            
            if (priceFilter) {
                filtered = filtered.filter(item => {
                    switch(priceFilter) {
                        case 'å¼•æµå±‚':
                            return item.price_entry && parseInt(item.price_entry) < 100;
                        case 'è½¬åŒ–å±‚':
                            return item.price_mid && parseInt(item.price_mid) >= 199 && parseInt(item.price_mid) <= 999;
                        case 'é«˜å®¢å•å±‚':
                            return item.price_high && parseInt(item.price_high) >= 1000;
                        default:
                            return true;
                    }
                });
            }
            
            if (trustFilter) {
                filtered = filtered.filter(item => item.trust_score === trustFilter);
            }
            
            if (searchTerm) {
                filtered = filtered.filter(item => 
                    (item.peer_name && item.peer_name.toLowerCase().includes(searchTerm)) ||
                    (item.peer_description && item.peer_description.toLowerCase().includes(searchTerm)) ||
                    (item.product_main && item.product_main.toLowerCase().includes(searchTerm))
                );
            }
            
            return filtered;
        }

        function updateStats() {
            $('#stat-total').text(researchData.length);
            
            const platforms = new Set();
            let highTrustCount = 0;
            let highValueCount = 0;
            
            researchData.forEach(item => {
                if (item.platforms) {
                    item.platforms.forEach(p => platforms.add(p));
                }
                if (item.trust_score && (item.trust_score.includes('4') || item.trust_score.includes('5'))) {
                    highTrustCount++;
                }
                if (item.reference_value && item.reference_value.includes('éå¸¸æœ‰ä»·å€¼')) {
                    highValueCount++;
                }
            });
            
            $('#stat-platforms').text(platforms.size);
            $('#stat-high-trust').text(highTrustCount);
            $('#stat-high-value').text(highValueCount);
        }

        function updateAnalysis() {
            updateStats();
            updateCharts();
            updateIntelligentAnalysis();
        }

        function updateCharts() {
            // å¹³å°åˆ†å¸ƒå›¾
            const platformCount = {};
            researchData.forEach(item => {
                if (item.platforms) {
                    item.platforms.forEach(platform => {
                        platformCount[platform] = (platformCount[platform] || 0) + 1;
                    });
                }
            });
            
            const platformCtx = document.getElementById('platform-chart').getContext('2d');
            new Chart(platformCtx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(platformCount),
                    datasets: [{
                        data: Object.values(platformCount),
                        backgroundColor: [
                            '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0',
                            '#9966FF', '#FF9F40', '#FF6384', '#C9CBCF'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
            
            // äº§å“ç±»å‹åˆ†å¸ƒå›¾
            const productTypeCount = {};
            researchData.forEach(item => {
                if (item.product_types && Array.isArray(item.product_types)) {
                    item.product_types.forEach(type => {
                        productTypeCount[type] = (productTypeCount[type] || 0) + 1;
                    });
                }
            });
            
            const productTypeCtx = document.getElementById('product-type-chart').getContext('2d');
            new Chart(productTypeCtx, {
                type: 'bar',
                data: {
                    labels: Object.keys(productTypeCount),
                    datasets: [{
                        label: 'æ•°é‡',
                        data: Object.values(productTypeCount),
                        backgroundColor: '#667eea'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        function updateIntelligentAnalysis() {
            if (researchData.length === 0) {
                $('#success-patterns').html('<p class="text-muted">æš‚æ— æ•°æ®ï¼Œè¯·å…ˆæ·»åŠ è°ƒç ”è®°å½•</p>');
                $('#risk-alerts').html('<p class="text-muted">æš‚æ— æ•°æ®ï¼Œè¯·å…ˆæ·»åŠ è°ƒç ”è®°å½•</p>');
                $('#opportunities').html('<p class="text-muted">æš‚æ— æ•°æ®ï¼Œè¯·å…ˆæ·»åŠ è°ƒç ”è®°å½•</p>');
                $('#recommendations').html('<p class="text-muted">æš‚æ— æ•°æ®ï¼Œè¯·å…ˆæ·»åŠ è°ƒç ”è®°å½•</p>');
                return;
            }
            
            // æˆåŠŸå¥—è·¯æ€»ç»“
            const patterns = [];
            const trafficTypes = {};
            const productTypes = {};
            
            researchData.forEach(item => {
                if (item.traffic_path_type) {
                    trafficTypes[item.traffic_path_type] = (trafficTypes[item.traffic_path_type] || 0) + 1;
                }
                if (item.product_type) {
                    productTypes[item.product_type] = (productTypes[item.product_type] || 0) + 1;
                }
            });
            
            const topTrafficType = Object.entries(trafficTypes).sort((a, b) => b[1] - a[1])[0];
            const topProductType = Object.entries(productTypes).sort((a, b) => b[1] - a[1])[0];
            
            if (topTrafficType) {
                patterns.push(`æœ€æœ‰æ•ˆçš„æµé‡æ¨¡å¼ï¼š<strong>${topTrafficType[0]}</strong> (${topTrafficType[1]}ä¸ªåŒè¡Œåœ¨ä½¿ç”¨)`);
            }
            if (topProductType) {
                patterns.push(`æœ€å—æ¬¢è¿çš„äº§å“ç±»å‹ï¼š<strong>${topProductType[0]}</strong> (${topProductType[1]}ä¸ªåŒè¡Œåœ¨åš)`);
            }
            
            // é£é™©æé†’
            const risks = [];
            const lowTrustCount = researchData.filter(item => item.trust_score && item.trust_score.includes('1') || item.trust_score.includes('2')).length;
            if (lowTrustCount > 0) {
                risks.push(`å‘ç° <strong>${lowTrustCount}</strong> ä¸ªä½ä¿¡ä»»åº¦åŒè¡Œï¼Œéœ€è¦è°¨æ…å‚è€ƒ`);
            }
            
            const noProductDesign = researchData.filter(item => !item.product_entry && !item.product_mid && !item.product_high).length;
            if (noProductDesign > 0) {
                risks.push(`<strong>${noProductDesign}</strong> ä¸ªåŒè¡Œç¼ºä¹äº§å“å±‚çº§è®¾è®¡ï¼Œå˜ç°èƒ½åŠ›æœ‰é™`);
            }
            
            // æœºä¼šç‚¹
            const opportunities = [];
            const highTrustHighValue = researchData.filter(item => 
                (item.trust_score && (item.trust_score.includes('4') || item.trust_score.includes('5'))) &&
                (item.reference_value && item.reference_value.includes('éå¸¸æœ‰ä»·å€¼'))
            );
            
            if (highTrustHighValue.length > 0) {
                opportunities.push(`å‘ç° <strong>${highTrustHighValue.length}</strong> ä¸ªé«˜ä»·å€¼é«˜ä¿¡ä»»åº¦åŒè¡Œï¼Œå€¼å¾—æ·±åº¦å­¦ä¹ `);
            }
            
            const underusedPlatforms = ['çŸ¥ä¹', 'Bç«™', 'å¾®åš'].filter(platform => {
                const count = researchData.filter(item => item.platforms && item.platforms.includes(platform)).length;
                return count < researchData.length * 0.2; // ä½¿ç”¨ç‡ä½äº20%
            });
            
            if (underusedPlatforms.length > 0) {
                opportunities.push(`<strong>${underusedPlatforms.join(',')}</strong> ç­‰å¹³å°ç«äº‰è¾ƒå°ï¼Œå¯ä»¥è€ƒè™‘è¿›å…¥`);
            }
            
            // è¡ŒåŠ¨å»ºè®®
            const recommendations = [];
            recommendations.push('ä¼˜å…ˆå­¦ä¹ é«˜ä¿¡ä»»åº¦åŒè¡Œçš„è¿è¥ç­–ç•¥');
            recommendations.push('å®Œå–„äº§å“å±‚çº§è®¾è®¡ï¼Œæå‡å®¢æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼');
            recommendations.push('å¤šå¹³å°å¸ƒå±€ï¼Œé™ä½å•ä¸€å¹³å°é£é™©');
            
            // æ›´æ–°é¡µé¢
            $('#success-patterns').html(patterns.length > 0 ? patterns.map(p => `<p>â€¢ ${p}</p>`).join('') : '<p class="text-muted">æš‚æ— æ˜¾è‘—æ¨¡å¼</p>');
            $('#risk-alerts').html(risks.length > 0 ? risks.map(r => `<p>âš ï¸ ${r}</p>`).join('') : '<p class="text-muted">æš‚æ— æ˜æ˜¾é£é™©</p>');
            $('#opportunities').html(opportunities.length > 0 ? opportunities.map(o => `<p>ğŸ’¡ ${o}</p>`).join('') : '<p class="text-muted">ç»§ç»­è§‚å¯Ÿä¸­</p>');
            $('#recommendations').html(recommendations.map(r => `<p>ğŸ“‹ ${r}</p>`).join(''));
        }

        function viewDetail(id) {
            const item = researchData.find(d => d.id === id);
            if (!item) return;
            
            let modalContent = `
                <div class="row">
                    <div class="col-md-6">
                        <h6>åŸºæœ¬ä¿¡æ¯</h6>
                        <p><strong>è°ƒç ”æ—¥æœŸï¼š</strong>${item.research_date}</p>
                        <p><strong>åŒè¡Œæ˜µç§°ï¼š</strong>${item.peer_name || 'æœªå¡«å†™'}</p>
                        <p><strong>å¹³å°ï¼š</strong>${item.platforms ? item.platforms.join(', ') : ''}</p>
                        <p><strong>æè¿°ï¼š</strong>${item.peer_description || 'æœªå¡«å†™'}</p>
                        <p><strong>å®¢æˆ·ç¾¤ä½“ï¼š</strong>${item.customer_type === 'To C' ? 'é¢å‘ä¸ªäººæ¶ˆè´¹è€…' : item.customer_type === 'To B' ? 'é¢å‘ä¼ä¸šå®¢æˆ·' : item.customer_type === 'ä¸¤è€…éƒ½æœ‰' ? 'ä¸¤è€…éƒ½æœ‰' : 'æœªå¡«å†™'}</p>
                        <p><strong>è¿è¥ä¸»ä½“ï¼š</strong>${item.operation_entity === 'ä¸ªäºº' ? 'ä¸ªäººè¿è¥' : item.operation_entity === 'å°å›¢é˜Ÿ' ? 'å°å›¢é˜Ÿ (2-5äºº)' : item.operation_entity === 'ä¸­å‹å›¢é˜Ÿ' ? 'ä¸­å‹å›¢é˜Ÿ (6-20äºº)' : item.operation_entity === 'å¤§å›¢é˜Ÿ' ? 'å¤§å›¢é˜Ÿ (20äººä»¥ä¸Š)' : item.operation_entity === 'å…¬å¸' ? 'å…¬å¸åŒ–è¿è¥' : 'æœªå¡«å†™'}</p>
                        <p><strong>å¸å¼•ç‚¹ï¼š</strong>${item.attraction_point || 'æœªå¡«å†™'}</p>
                        <p><strong>è”ç³»æ–¹å¼ï¼š</strong>${item.contact_method || 'æœªå¡«å†™'}</p>
                        <p><strong>æ˜¯å¦ç»§ç»­ï¼š</strong>${item.contact_added || 'æœªå¡«å†™'}</p>
                    </div>
                    <div class="col-md-6">
                        <h6>æµé‡åˆ†æ</h6>
                        <p><strong>ä¸»è¦é˜µåœ°ï¼š</strong>${item.main_platforms ? item.main_platforms.join(', ') : 'æœªå¡«å†™'}</p>
                        <p><strong>è·¯å¾„ç±»å‹ï¼š</strong>${item.traffic_path_type || 'æœªå¡«å†™'}</p>
                        <p><strong>æµé‡å½¢å¼ï¼š</strong>${item.traffic_forms ? item.traffic_forms.join(', ') : ''}</p>
                        <p><strong>å‘å¸ƒé¢‘ç‡ï¼š</strong>${item.content_frequency || 'æœªå¡«å†™'}</p>
                        <p><strong>äº’åŠ¨æ´»è·ƒåº¦ï¼š</strong>${item.interaction_level || 'æœªå¡«å†™'}</p>
                    </div>
                </div>
                <hr>
                <div class="row">
                    <div class="col-md-6">
                        <h6>äº§å“åˆ†æ</h6>
                        <p><strong>ä¸»è¦äº§å“ï¼š</strong>${item.product_main || 'æœªå¡«å†™'}</p>
                        <p><strong>äº§å“ç±»å‹ï¼š</strong>${item.product_types ? item.product_types.join(', ') : 'æœªå¡«å†™'}</p>
                        <p><strong>å˜ç°å½¢å¼ï¼š</strong>${item.monetization_methods ? item.monetization_methods.join(', ') : 'æœªå¡«å†™'}</p>
                        <p><strong>å¼•æµäº§å“ï¼š</strong>${item.product_entry || 'æ— '} (${item.price_entry || ''})</p>
                        <p><strong>è½¬åŒ–äº§å“ï¼š</strong>${item.product_mid || 'æ— '} (${item.price_mid || ''})</p>
                        <p><strong>é«˜å®¢å•äº§å“ï¼š</strong>${item.product_high || 'æ— '} (${item.price_high || ''})</p>
                        <p><strong>äº¤ä»˜æ–¹å¼ï¼š</strong>${item.delivery_method || 'æœªå¡«å†™'}</p>
                        <p><strong>äº¤ä»˜å‘¨æœŸï¼š</strong>${item.delivery_period || 'æœªå¡«å†™'}</p>
                        <p><strong>äº¤ä»˜åœ°ç‚¹ï¼š</strong>${item.delivery_location || 'æœªå¡«å†™'}</p>
                    </div>
                    <div class="col-md-6">
                        <h6>è¿è¥åˆ†æ</h6>
                        <p><strong>è·å®¢æ¸ é“ï¼š</strong>${item.acquisition_channel || 'æœªå¡«å†™'}</p>
                        <p><strong>è½¬åŒ–è·¯å¾„ï¼š</strong>${item.conversion_path || 'æœªå¡«å†™'}</p>
                        <p><strong>å®¢æˆ·ç»´æŠ¤ï¼š</strong>${item.customer_maintenance || 'æœªå¡«å†™'}</p>
                        <p><strong>æ˜¯å¦åŒ…å«å”®åï¼š</strong>${item.after_sales_service || 'æœªå¡«å†™'}</p>
                        <p><strong>å”®åæœåŠ¡å†…å®¹ï¼š</strong>${item.after_sales_content || 'æœªå¡«å†™'}</p>
                        <p><strong>å®¢æˆ·ç»´æŠ¤ç­–ç•¥ï¼š</strong>${item.customer_maintenance_strategy || 'æœªå¡«å†™'}</p>
                        <p><strong>å¤è´­ç­–ç•¥ï¼š</strong>${item.repurchase_strategy || 'æœªå¡«å†™'}</p>
                        <p><strong>è¥æ”¶é¢„ä¼°ï¼š</strong>${item.revenue_estimate || 'æœªå¡«å†™'}</p>
                        <p><strong>ä¿¡ä»»åº¦ï¼š</strong>${item.trust_score || 'æœªå¡«å†™'}</p>
                        <p><strong>å‚è€ƒä»·å€¼ï¼š</strong>${item.reference_value || 'æœªå¡«å†™'}</p>
                    </div>
                </div>
                <hr>
                <div class="row">
                    <div class="col-12">
                        <h6>æ ¸å¿ƒå–ç‚¹</h6>
                        <p>${item.product_selling_point || 'æœªå¡«å†™'}</p>
                        <h6>å®šä»·ç­–ç•¥</h6>
                        <p>${item.pricing_strategy || 'æœªå¡«å†™'}</p>
                        <h6>ä¼˜æƒ æ´»åŠ¨</h6>
                        <p>${item.promotion_info || 'æœªå¡«å†™'}</p>
                        <h6>å€¼å¾—å­¦ä¹ çš„åœ°æ–¹</h6>
                        <p>${item.learning_points || 'æœªå¡«å†™'}</p>
                        <h6>éœ€è¦æ”¹è¿›çš„åœ°æ–¹</h6>
                        <p>${item.improvement_points || 'æœªå¡«å†™'}</p>
                    </div>
                </div>
            `;
            
            $('#modal-body').html(modalContent);
            const modal = new bootstrap.Modal(document.getElementById('detailModal'));
            modal.show();
        }

        function editItem(id) {
            const item = researchData.find(d => d.id === id);
            if (!item) return;
            
            currentEditingId = id;
            
            // å¡«å……è¡¨å•
            $('#research_date').val(item.research_date);
            $('#peer_name').val(item.peer_name || '');
            $('#peer_description').val(item.peer_description || '');
            $('#customer_type').val(item.customer_type || '');
            $('#operation_entity').val(item.operation_entity || '');
            $('#attraction_point').val(item.attraction_point || '');
            $('#contact_method').val(item.contact_method || '');
            $('#contact_added').val(item.contact_added || '');
            $('#traffic_path_type').val(item.traffic_path_type || '');
            $('#custom_path').val(item.custom_path || '');
            $('#content_frequency').val(item.content_frequency || '');
            $('#interaction_level').val(item.interaction_level || '');
            $('#product_main').val(item.product_main || '');
            $('#product_type').val(item.product_type || '');
            $('#product_entry').val(item.product_entry || '');
            $('#price_entry').val(item.price_entry || '');
            $('#product_mid').val(item.product_mid || '');
            $('#price_mid').val(item.price_mid || '');
            $('#product_high').val(item.product_high || '');
            $('#price_high').val(item.price_high || '');
            $('#delivery_method_entry').val(item.delivery_method_entry || '');
            $('#delivery_period_entry').val(item.delivery_period_entry || '');
            $('#delivery_method_mid').val(item.delivery_method_mid || '');
            $('#delivery_period_mid').val(item.delivery_period_mid || '');
            $('#delivery_method_high').val(item.delivery_method_high || '');
            $('#delivery_period_high').val(item.delivery_period_high || '');
            $('#delivery_location').val(item.delivery_location || '');
            $('#product_selling_point').val(item.product_selling_point || '');
            $('#pricing_strategy').val(item.pricing_strategy || '');
            $('#promotion_info').val(item.promotion_info || '');
            $('#seen_acquisition_channel').val(item.seen_acquisition_channel || '');
            $('#conversion_path').val(item.conversion_path || '');
            $('#customer_maintenance').val(item.customer_maintenance || '');
            $('#after_sales_service').val(item.after_sales_service || '');
            $('#after_sales_content').val(item.after_sales_content || '');
            $('#customer_maintenance_strategy').val(item.customer_maintenance_strategy || '');
            $('#repurchase_strategy').val(item.repurchase_strategy || '');
            $('#revenue_estimate').val(item.revenue_estimate || '');
            $('#trust_score').val(item.trust_score || '');
            $('#reference_value').val(item.reference_value || '');
            $('#learning_points').val(item.learning_points || '');
            $('#improvement_points').val(item.improvement_points || '');
            
            // è®¾ç½®åŸºç¡€ä¿¡æ¯é¡µé¢çš„è°ƒç ”å¹³å°é€‰æ‹©
            $('#research_platforms option:selected').prop('selected', false); // æ¸…ç©ºä¸‹æ‹‰æ¡†é€‰æ‹©
            userSelectedPlatforms = []; // é‡ç½®ç”¨æˆ·é€‰æ‹©é¡ºåº
            if (item.platforms) {
                item.platforms.forEach(platform => {
                    // è®¾ç½®ä¸‹æ‹‰æ¡†é€‰ä¸­çŠ¶æ€
                    $(`#research_platforms option[value="${platform}"]`).prop('selected', true);
                });
            }
            
            // è®¾ç½®æµé‡åˆ†æé¡µé¢çš„ä¸»è¦æµé‡é˜µåœ°é€‰æ‹©
            $('.form-section[data-section="2"] .platform-chip').removeClass('selected');
            if (item.main_platforms) {
                item.main_platforms.forEach(platform => {
                    $(`.form-section[data-section="2"] .platform-chip[data-platform="${platform}"]`).addClass('selected');
                });
            }
            
            // è®¾ç½®æµé‡å½¢å¼é€‰æ‹©
            $('input[type="checkbox"][id^="traffic_"]').prop('checked', false);
            if (item.traffic_forms) {
                item.traffic_forms.forEach(form => {
                    // ç®€å•åŒ¹é…ï¼Œå®é™…åº”è¯¥æ›´ç²¾ç¡®
                    $('input[type="checkbox"][id^="traffic_"]').each(function() {
                        if ($(this).next('label').text().includes(form)) {
                            $(this).prop('checked', true);
                        }
                    });
                });
            }
            
            // è®¾ç½®å”®åæœåŠ¡å¤šé€‰æ¡†
            $('input[type="checkbox"][id^="after_sales_"]').prop('checked', false);
            if (item.after_sales_services) {
                item.after_sales_services.forEach(service => {
                    $('input[type="checkbox"][id^="after_sales_"]').each(function() {
                        if ($(this).next('label').text().includes(service)) {
                            $(this).prop('checked', true);
                        }
                    });
                });
            }
            
            // è®¾ç½®äº§å“ç±»å‹å¤šé€‰
            $('#product_types option').prop('selected', false);
            if (item.product_types) {
                item.product_types.forEach(type => {
                    $(`#product_types option[value="${type}"]`).prop('selected', true);
                });
            }
            
            // è®¾ç½®å˜ç°å½¢å¼å¤šé€‰
            $('#monetization_types option').prop('selected', false);
            if (item.monetization_methods) {
                item.monetization_methods.forEach(method => {
                    $(`#monetization_types option[value="${method}"]`).prop('selected', true);
                });
            }
            
            // è®¾ç½®å…·ä½“äº¤ä»˜å½¢å¼å¤šé€‰
            $('#delivery_methods option').prop('selected', false);
            if (item.delivery_methods) {
                item.delivery_methods.forEach(method => {
                    $(`#delivery_methods option[value="${method}"]`).prop('selected', true);
                });
            }
            
            generateTrafficPathFromOrder();
            updateTrafficPath();
            
            // åˆ‡æ¢åˆ°è¡¨å•é¡µé¢
            switchTab('form');
        }

        function deleteItem(id) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡è°ƒç ”è®°å½•å—ï¼Ÿ')) {
                researchData = researchData.filter(item => item.id !== id);
                localStorage.setItem('researchData', JSON.stringify(researchData));
                updateTable();
                updateAnalysis();
            }
        }

        function exportData(format) {
            if (researchData.length === 0) {
                alert('æš‚æ— æ•°æ®å¯å¯¼å‡º');
                return;
            }
            
            const exportData = researchData.map(item => ({
                'è°ƒç ”æ—¥æœŸ': item.research_date,
                'åŒè¡Œæ˜µç§°': item.peer_name || '',
                'å¹³å°': item.platforms ? item.platforms.join(', ') : '',
                'ä¸»è¦äº§å“': item.product_main || '',
                'å®¢æˆ·ç¾¤ä½“': item.customer_type || '',
                'è¿è¥ä¸»ä½“': item.operation_entity || '',
                'äº§å“ç±»å‹': item.product_types ? item.product_types.join(', ') : '',
                'å˜ç°å½¢å¼': item.monetization_methods ? item.monetization_methods.join(', ') : '',
                'å¼•æµäº§å“': item.product_entry || '',
                'å¼•æµä»·æ ¼': item.price_entry || '',
                'è½¬åŒ–äº§å“': item.product_mid || '',
                'è½¬åŒ–ä»·æ ¼': item.price_mid || '',
                'é«˜å®¢å•äº§å“': item.product_high || '',
                'é«˜å®¢å•ä»·æ ¼': item.price_high || '',
                'äº¤ä»˜æ–¹å¼': item.delivery_method || '',
                'äº¤ä»˜å‘¨æœŸ': item.delivery_period || '',
                'äº¤ä»˜åœ°ç‚¹': item.delivery_location || '',
                'æ ¸å¿ƒå–ç‚¹': item.product_selling_point || '',
                'å®šä»·ç­–ç•¥': item.pricing_strategy || '',
                'ä¼˜æƒ æ´»åŠ¨': item.promotion_info || '',
                'ä¸»è¦æµé‡é˜µåœ°': item.main_platforms ? item.main_platforms.join(', ') : '',
                'æµé‡è·¯å¾„': item.traffic_path_type || '',
        'æµé‡å½¢å¼': item.traffic_forms ? item.traffic_forms.join(', ') : '',
        'å‘å¸ƒé¢‘ç‡': item.content_frequency || '',
        'äº’åŠ¨æ´»è·ƒåº¦': item.interaction_level || '',
        'è·å®¢æ¸ é“': item.acquisition_channel || '',
        'è½¬åŒ–è·¯å¾„': item.conversion_path || '',
        'å®¢æˆ·ç»´æŠ¤': item.customer_maintenance || '',
        'æ˜¯å¦åŒ…å«å”®å': item.after_sales_service || '',
        'å”®åæœåŠ¡å†…å®¹': item.after_sales_content || '',
        'å®¢æˆ·ç»´æŠ¤ç­–ç•¥': item.customer_maintenance_strategy || '',
        'å¤è´­ç­–ç•¥': item.repurchase_strategy || '',
        'è¥æ”¶æ°´å¹³': item.revenue_estimate || '',
        'ä¿¡ä»»åº¦': item.trust_score || '',
        'å‚è€ƒä»·å€¼': item.reference_value || '',
        'å¸å¼•ç‚¹': item.attraction_point || '',
        'è”ç³»æ–¹å¼': item.contact_method || '',
        'æ˜¯å¦ç»§ç»­': item.contact_added || '',
        'æè¿°': item.peer_description || '',
        'å­¦ä¹ ç‚¹': item.learning_points || '',
        'æ”¹è¿›ç‚¹': item.improvement_points || '',
        'åˆ›å»ºæ—¶é—´': item.created_at
            }));
            
            if (format === 'excel') {
                const ws = XLSX.utils.json_to_sheet(exportData);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, 'åŒè¡Œè°ƒç ”æ•°æ®');
                XLSX.writeFile(wb, 'åŒè¡Œè°ƒç ”æ•°æ®.xlsx');
            } else if (format === 'csv') {
                const ws = XLSX.utils.json_to_sheet(exportData);
                const csv = XLSX.utils.sheet_to_csv(ws);
                const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'åŒè¡Œè°ƒç ”æ•°æ®.csv';
                link.click();
            } else if (format === 'json') {
                const dataStr = JSON.stringify(exportData, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(dataBlob);
                link.download = 'åŒè¡Œè°ƒç ”æ•°æ®.json';
                link.click();
            }
        }

        // å¯¼å…¥æ¨¡ç‰ˆåŠŸèƒ½
        function exportTemplate() {
            const templateData = [{
                'è°ƒç ”æ—¥æœŸ': '2025-01-01',
                'åŒè¡Œæ˜µç§°': 'ç¤ºä¾‹åŒè¡Œ',
                'å¹³å°': 'å°çº¢ä¹¦, å¾®ä¿¡',
                'ä¸»è¦äº§å“': 'ç¤ºä¾‹äº§å“',
                'å®¢æˆ·ç¾¤ä½“': 'ç›®æ ‡å®¢æˆ·',
                'è¿è¥ä¸»ä½“': 'ä¸ªäºº/å›¢é˜Ÿ',
                'äº§å“ç±»å‹': 'è™šæ‹Ÿäº§å“, å®ä½“äº§å“',
                'å˜ç°å½¢å¼': 'äº§å“é”€å”®, æœåŠ¡æ”¶è´¹',
                'å¼•æµäº§å“': 'å…¥é—¨äº§å“',
                'å¼•æµä»·æ ¼': '99',
                'è½¬åŒ–äº§å“': 'æ ¸å¿ƒäº§å“',
                'è½¬åŒ–ä»·æ ¼': '999',
                'é«˜ä»·å€¼äº§å“': 'é«˜ç«¯äº§å“',
                'é«˜ä»·å€¼ä»·æ ¼': '9999',
                'æµé‡è·¯å¾„': 'å°çº¢ä¹¦â†’ç§åŸŸï¼ˆå¾®ä¿¡ï¼‰',
                'æµé‡å½¢å¼': 'UGCå›¾æ–‡, çŸ­è§†é¢‘',
                'å†…å®¹é¢‘ç‡': 'å‘¨æ›´2-3æ¬¡',
                'äº’åŠ¨ç¨‹åº¦': 'è¾ƒé«˜',
                'è½¬åŒ–è·¯å¾„': 'å…¬åŸŸå¼•æµâ†’ç§åŸŸè½¬åŒ–â†’å®¢æˆ·ç»´æŠ¤',
                'å®¢æˆ·ç»´æŠ¤': 'å¾®ä¿¡ç¤¾ç¾¤, 1å¯¹1æœåŠ¡',
                'æ˜¯å¦åŒ…å«å”®å': 'æ˜¯',
                'å”®åæœåŠ¡å†…å®¹': 'æŠ€æœ¯æ”¯æŒ, å’¨è¯¢æœåŠ¡',
                'å®¢æˆ·ç»´æŠ¤ç­–ç•¥': 'å®šæœŸå›è®¿, ä¸“å±æœåŠ¡',
                'å¤è´­ç­–ç•¥': 'ä¼šå‘˜ä½“ç³», å‡çº§æœåŠ¡',
                'è¥æ”¶æ°´å¹³': 'æœˆæ”¶å…¥5-10ä¸‡',
                'ä¿¡ä»»åº¦': '4-5åˆ†',
                'å‚è€ƒä»·å€¼': 'éå¸¸æœ‰ä»·å€¼',
                'å¸å¼•ç‚¹': 'å†…å®¹è´¨é‡é«˜, æœåŠ¡ä¸“ä¸š',
                'è”ç³»æ–¹å¼': 'å¾®ä¿¡: example123',
                'æ˜¯å¦ç»§ç»­': 'å·²æ·»åŠ ',
                'æè¿°': 'è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹æ•°æ®ï¼Œè¯·æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹',
                'å­¦ä¹ ç‚¹': 'ä¼˜ç§€çš„è¿è¥ç­–ç•¥',
                'æ”¹è¿›ç‚¹': 'å¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹',
                'åˆ›å»ºæ—¶é—´': new Date().toISOString()
            }];
            
            const ws = XLSX.utils.json_to_sheet(templateData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'åŒè¡Œè°ƒç ”æ¨¡ç‰ˆ');
            XLSX.writeFile(wb, 'åŒè¡Œè°ƒç ”æ•°æ®å¯¼å…¥æ¨¡ç‰ˆ.xlsx');
            
            alert('æ¨¡ç‰ˆå·²ä¸‹è½½ï¼Œè¯·æŒ‰ç…§æ¨¡ç‰ˆæ ¼å¼å¡«å†™æ•°æ®åå¯¼å…¥');
        }

        // å¯¼å…¥æ•°æ®åŠŸèƒ½
        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    let data;
                    const fileName = file.name.toLowerCase();
                    
                    if (fileName.endsWith('.json')) {
                        data = JSON.parse(e.target.result);
                    } else if (fileName.endsWith('.csv')) {
                        const csv = e.target.result;
                        const ws = XLSX.read(csv, { type: 'string' });
                        data = XLSX.utils.sheet_to_json(ws.Sheets[ws.SheetNames[0]]);
                    } else if (fileName.endsWith('.xlsx') || fileName.endsWith('.xls')) {
                        const workbook = XLSX.read(e.target.result, { type: 'binary' });
                        data = XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[0]]);
                    }
                    
                    if (data && Array.isArray(data)) {
                        // è½¬æ¢æ•°æ®æ ¼å¼
                        const importedData = data.map((item, index) => {
                            const record = {
                                id: Date.now() + index,
                                research_date: item['è°ƒç ”æ—¥æœŸ'] || '',
                                peer_name: item['åŒè¡Œæ˜µç§°'] || '',
                                platforms: item['å¹³å°'] ? item['å¹³å°'].split(',').map(p => p.trim()) : [],
                                product_main: item['ä¸»è¦äº§å“'] || '',
                                customer_type: item['å®¢æˆ·ç¾¤ä½“'] || '',
                                operation_entity: item['è¿è¥ä¸»ä½“'] || '',
                                product_types: item['äº§å“ç±»å‹'] ? item['äº§å“ç±»å‹'].split(',').map(p => p.trim()) : [],
                                monetization_methods: item['å˜ç°å½¢å¼'] ? item['å˜ç°å½¢å¼'].split(',').map(m => m.trim()) : [],
                                product_entry: item['å¼•æµäº§å“'] || '',
                                price_entry: item['å¼•æµä»·æ ¼'] || '',
                                product_mid: item['è½¬åŒ–äº§å“'] || '',
                                price_mid: item['è½¬åŒ–ä»·æ ¼'] || '',
                                product_high: item['é«˜ä»·å€¼äº§å“'] || '',
                                price_high: item['é«˜ä»·å€¼ä»·æ ¼'] || '',
                                traffic_path: item['æµé‡è·¯å¾„'] || '',
                                traffic_forms: item['æµé‡å½¢å¼'] ? item['æµé‡å½¢å¼'].split(',').map(f => f.trim()) : [],
                                content_frequency: item['å†…å®¹é¢‘ç‡'] || '',
                                interaction_level: item['äº’åŠ¨ç¨‹åº¦'] || '',
                                conversion_path: item['è½¬åŒ–è·¯å¾„'] || '',
                                customer_maintenance: item['å®¢æˆ·ç»´æŠ¤'] ? item['å®¢æˆ·ç»´æŠ¤'].split(',').map(m => m.trim()) : [],
                                after_sales_service: item['æ˜¯å¦åŒ…å«å”®å'] || '',
                                after_sales_content: item['å”®åæœåŠ¡å†…å®¹'] || '',
                                customer_maintenance_strategy: item['å®¢æˆ·ç»´æŠ¤ç­–ç•¥'] || '',
                                repurchase_strategy: item['å¤è´­ç­–ç•¥'] || '',
                                revenue_estimate: item['è¥æ”¶æ°´å¹³'] || '',
                                trust_score: item['ä¿¡ä»»åº¦'] || '',
                                reference_value: item['å‚è€ƒä»·å€¼'] || '',
                                attraction_point: item['å¸å¼•ç‚¹'] || '',
                                contact_method: item['è”ç³»æ–¹å¼'] || '',
                                contact_added: item['æ˜¯å¦ç»§ç»­'] || '',
                                peer_description: item['æè¿°'] || '',
                                learning_points: item['å­¦ä¹ ç‚¹'] || '',
                                improvement_points: item['æ”¹è¿›ç‚¹'] || '',
                                created_at: item['åˆ›å»ºæ—¶é—´'] || new Date().toISOString()
                            };
                            return record;
                        });
                        
                        // åˆå¹¶åˆ°ç°æœ‰æ•°æ®
                        researchData = [...researchData, ...importedData];
                        localStorage.setItem('researchData', JSON.stringify(researchData));
                        
                        // åˆ·æ–°é¡µé¢æ˜¾ç¤º
                        loadTableData();
                        updateStatistics();
                        
                        alert(`æˆåŠŸå¯¼å…¥ ${importedData.length} æ¡æ•°æ®ï¼`);
                    } else {
                        alert('æ–‡ä»¶æ ¼å¼é”™è¯¯ï¼Œè¯·ä¸‹è½½æ¨¡ç‰ˆåæŒ‰ç…§æ ¼å¼å¡«å†™');
                    }
                } catch (error) {
                    console.error('å¯¼å…¥é”™è¯¯:', error);
                    alert('å¯¼å…¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶æ ¼å¼');
                }
            };
            
            if (file.name.toLowerCase().endsWith('.json')) {
                reader.readAsText(file);
            } else {
                reader.readAsBinaryString(file);
            }
            
            // æ¸…ç©ºfile input
            event.target.value = '';
        }

        function exportAnalysisReport() {
            if (researchData.length === 0) {
                alert('æš‚æ— æ•°æ®å¯å¯¼å‡º');
                return;
            }
            
            const reportContent = generateAnalysisReport();
            
            // åˆ›å»ºPDF
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // æ·»åŠ æ ‡é¢˜
            doc.setFontSize(20);
            doc.text('åŒè¡Œè°ƒç ”åˆ†ææŠ¥å‘Š', 20, 30);
            
            // æ·»åŠ ç”Ÿæˆæ—¶é—´
            doc.setFontSize(12);
            doc.text(`ç”Ÿæˆæ—¶é—´: ${new Date().toLocaleString()}`, 20, 45);
            
            // æ·»åŠ ç»Ÿè®¡æ¦‚è§ˆ
            doc.setFontSize(16);
            doc.text('ç»Ÿè®¡æ¦‚è§ˆ', 20, 65);
            doc.setFontSize(12);
            doc.text(`æ€»è°ƒç ”æ•°: ${researchData.length}`, 20, 80);
            doc.text(`æ¶‰åŠå¹³å°: ${new Set(researchData.flatMap(item => item.platforms || [])).size}`, 20, 90);
            doc.text(`é«˜ä¿¡ä»»åº¦åŒè¡Œ: ${researchData.filter(item => item.trust_score && (item.trust_score.includes('4') || item.trust_score.includes('5'))).length}`, 20, 100);
            doc.text(`é«˜ä»·å€¼åŒè¡Œ: ${researchData.filter(item => item.reference_value && item.reference_value.includes('éå¸¸æœ‰ä»·å€¼')).length}`, 20, 110);
            
            // æ·»åŠ å¹³å°åˆ†æ
            doc.setFontSize(16);
            doc.text('å¹³å°åˆ†æ', 20, 130);
            doc.setFontSize(12);
            
            const platformCount = {};
            researchData.forEach(item => {
                if (item.platforms) {
                    item.platforms.forEach(platform => {
                        platformCount[platform] = (platformCount[platform] || 0) + 1;
                    });
                }
            });
            
            let yPos = 145;
            Object.entries(platformCount).sort((a, b) => b[1] - a[1]).forEach(([platform, count]) => {
                doc.text(`${platform}: ${count}ä¸ªåŒè¡Œ (${(count/researchData.length*100).toFixed(1)}%)`, 20, yPos);
                yPos += 10;
            });
            
            // æ·»åŠ æ™ºèƒ½åˆ†æ
            doc.setFontSize(16);
            doc.text('æ™ºèƒ½åˆ†æ', 20, yPos + 20);
            doc.setFontSize(12);
            yPos += 35;
            
            const analysis = generateIntelligentAnalysis();
            doc.text('æˆåŠŸå¥—è·¯:', 20, yPos);
            yPos += 10;
            analysis.patterns.forEach(pattern => {
                const lines = doc.splitTextToSize(`â€¢ ${pattern}`, 170);
                doc.text(lines, 20, yPos);
                yPos += lines.length * 5 + 2;
            });
            
            yPos += 10;
            doc.text('é£é™©æé†’:', 20, yPos);
            yPos += 10;
            analysis.risks.forEach(risk => {
                const lines = doc.splitTextToSize(`âš ï¸ ${risk}`, 170);
                doc.text(lines, 20, yPos);
                yPos += lines.length * 5 + 2;
            });
            
            yPos += 10;
            doc.text('æœºä¼šç‚¹:', 20, yPos);
            yPos += 10;
            analysis.opportunities.forEach(opportunity => {
                const lines = doc.splitTextToSize(`ğŸ’¡ ${opportunity}`, 170);
                doc.text(lines, 20, yPos);
                yPos += lines.length * 5 + 2;
            });
            
            yPos += 10;
            doc.text('è¡ŒåŠ¨å»ºè®®:', 20, yPos);
            yPos += 10;
            analysis.recommendations.forEach(recommendation => {
                const lines = doc.splitTextToSize(`ğŸ“‹ ${recommendation}`, 170);
                doc.text(lines, 20, yPos);
                yPos += lines.length * 5 + 2;
            });
            
            doc.save('åŒè¡Œè°ƒç ”åˆ†ææŠ¥å‘Š.pdf');
        }

        function generateAnalysisReport() {
            const platformCount = {};
            const productTypeCount = {};
            let highTrustCount = 0;
            let highValueCount = 0;
            
            researchData.forEach(item => {
                if (item.platforms) {
                    item.platforms.forEach(platform => {
                        platformCount[platform] = (platformCount[platform] || 0) + 1;
                    });
                }
                if (item.product_types && Array.isArray(item.product_types)) {
                    item.product_types.forEach(type => {
                        productTypeCount[type] = (productTypeCount[type] || 0) + 1;
                    });
                }
                if (item.trust_score && (item.trust_score.includes('4') || item.trust_score.includes('5'))) {
                    highTrustCount++;
                }
                if (item.reference_value && item.reference_value.includes('éå¸¸æœ‰ä»·å€¼')) {
                    highValueCount++;
                }
            });
            
            return {
                platformCount,
                productTypeCount,
                highTrustCount,
                highValueCount,
                totalResearch: researchData.length
            };
        }

        function generateIntelligentAnalysis() {
            const patterns = [];
            const risks = [];
            const opportunities = [];
            const recommendations = [];
            
            // æ ¸å¿ƒæ•°æ®ç»Ÿè®¡
            const totalPeers = researchData.length;
            const highTrustPeers = researchData.filter(item => 
                item.trust_score && (item.trust_score.includes('4') || item.trust_score.includes('5'))
            ).length;
            
            // å¹³å°åˆ†å¸ƒåˆ†æ
            const platformStats = {};
            researchData.forEach(item => {
                if (item.platforms) {
                    item.platforms.forEach(platform => {
                        platformStats[platform] = (platformStats[platform] || 0) + 1;
                    });
                }
            });
            
            const topPlatforms = Object.entries(platformStats)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 3);
            
            // æˆåŠŸæ¨¡å¼æç‚¼
            if (topPlatforms.length > 0) {
                patterns.push(`ä¸»æµå¹³å°ï¼š${topPlatforms.map(p => `${p[0]}(${p[1]}ä¸ª)`).join('ã€')}`);
            }
            
            const multiProductCount = researchData.filter(item => 
                item.product_entry && item.product_mid
            ).length;
            if (multiProductCount > 0) {
                patterns.push(`äº§å“åˆ†å±‚ï¼š${multiProductCount}ä¸ªåŒè¡Œé‡‡ç”¨å¤šäº§å“ç­–ç•¥`);
            }
            
            // é£é™©è¯†åˆ«
            const lowTrustCount = researchData.filter(item => 
                item.trust_score && (item.trust_score.includes('1') || item.trust_score.includes('2'))
            ).length;
            if (lowTrustCount > 0) {
                risks.push(`ä½ä¿¡ä»»åº¦åŒè¡Œï¼š${lowTrustCount}ä¸ª (${(lowTrustCount/totalPeers*100).toFixed(1)}%)`);
            }
            
            const singleProductCount = researchData.filter(item => 
                !item.product_mid && !item.product_high
            ).length;
            if (singleProductCount > totalPeers * 0.6) {
                risks.push(`${(singleProductCount/totalPeers*100).toFixed(1)}%åŒè¡Œç¼ºä¹äº§å“ä½“ç³»`);
            }
            
            // æœºä¼šç‚¹
            if (highTrustPeers > 0) {
                opportunities.push(`é«˜ä»·å€¼ç›®æ ‡ï¼š${highTrustPeers}ä¸ªé«˜ä¿¡ä»»åº¦åŒè¡Œ`);
            }
            
            const nichePlatforms = Object.entries(platformStats)
                .filter(([_, count]) => count < totalPeers * 0.15)
                .map(([platform, _]) => platform);
            
            if (nichePlatforms.length > 0) {
                opportunities.push(`è“æµ·å¹³å°ï¼š${nichePlatforms.join('ã€')}`);
            }
            
            // æ ¸å¿ƒå»ºè®®
            recommendations.push('èšç„¦å¤´éƒ¨å¹³å°ï¼Œå­¦ä¹ é«˜ä¿¡ä»»åº¦åŒè¡Œ');
            recommendations.push('æ„å»ºäº§å“çŸ©é˜µï¼Œé¿å…å•ä¸€ä¾èµ–');
            recommendations.push('å…³æ³¨ç»†åˆ†å¹³å°ï¼Œå¯»æ‰¾å·®å¼‚åŒ–æœºä¼š');
            
            return {
                patterns,
                risks,
                opportunities,
                recommendations
            };
        }

        // æµé‡è·¯å¾„è‡ªåŠ¨ç”ŸæˆåŠŸèƒ½
        function generateTrafficPath() {
            const selectedPlatforms = [];
            // æŒ‰ç…§DOMé¡ºåºè·å–é€‰ä¸­çš„å¹³å°ï¼Œç¡®ä¿é¡ºåºæ­£ç¡®
            $('.platform-chip.selected').each(function(index) {
                selectedPlatforms.push($(this).data('platform'));
            });
            
            if (selectedPlatforms.length === 0) {
                $('#generated_path').text('è¯·å…ˆé€‰æ‹©è°ƒç ”å¹³å°');
                return;
            }
            
            // æ ¹æ®ç”¨æˆ·é€‰æ‹©çš„é¡ºåºç”Ÿæˆè·¯å¾„
            let pathText = selectedPlatforms.join(' â†’ ');
            
            $('#generated_path').text(pathText);
        }
        
        // è®°å½•ç”¨æˆ·ç‚¹å‡»é¡ºåºçš„å¹³å°æ•°ç»„
        let userSelectedPlatforms = [];
        
        // ä¿®æ”¹å¹³å°ç‚¹å‡»äº‹ä»¶ï¼Œè®°å½•ç”¨æˆ·çš„é€‰æ‹©é¡ºåºï¼ˆä»…é™ç¬¬äºŒé¡µçš„æµé‡é˜µåœ°ï¼‰
        $(document).on('click', '.form-section[data-section="2"] .platform-chip', function() {
            const platform = $(this).data('platform');
            const index = userSelectedPlatforms.indexOf(platform);
            
            if ($(this).hasClass('selected')) {
                // å¦‚æœæ˜¯å–æ¶ˆé€‰æ‹©ï¼Œä»æ•°ç»„ä¸­ç§»é™¤
                if (index > -1) {
                    userSelectedPlatforms.splice(index, 1);
                }
            } else {
                // å¦‚æœæ˜¯é€‰æ‹©ï¼Œæ·»åŠ åˆ°æ•°ç»„æœ«å°¾
                if (index === -1) {
                    userSelectedPlatforms.push(platform);
                }
            }
            
            // ä½¿ç”¨è®°å½•çš„é¡ºåºç”Ÿæˆè·¯å¾„
            generateTrafficPathFromOrder();
        });
        
        // æ ¹æ®ç”¨æˆ·é€‰æ‹©é¡ºåºç”Ÿæˆè·¯å¾„
        function generateTrafficPathFromOrder() {
            // è·å–åŸºç¡€é¡µé¢ä¸‹æ‹‰æ¡†é€‰ä¸­çš„å¹³å°
            const selectedPlatforms = [];
            $('#research_platforms option:selected').each(function() {
                selectedPlatforms.push($(this).val());
            });
            
            console.log('generateTrafficPathFromOrder è¢«è°ƒç”¨');
            console.log('ä¸‹æ‹‰æ¡†é€‰ä¸­å¹³å°ï¼š', selectedPlatforms);
            console.log('ç¬¬äºŒé¡µé€‰ä¸­å¹³å°ï¼š', userSelectedPlatforms);
            
            // å¦‚æœåŸºç¡€é¡µé¢æœ‰é€‰ä¸­å¹³å°ï¼Œä¼˜å…ˆä½¿ç”¨åŸºç¡€é¡µé¢çš„é€‰æ‹©
            if (selectedPlatforms.length > 0) {
                const pathText = selectedPlatforms.join(' â†’ ');
                $('#generated_path').text(pathText);
                console.log('ä½¿ç”¨ä¸‹æ‹‰æ¡†é€‰æ‹©ç”Ÿæˆè·¯å¾„ï¼š', pathText);
                return;
            }
            
            // å¦‚æœåŸºç¡€é¡µé¢æ²¡æœ‰é€‰ä¸­ï¼Œä½¿ç”¨ç¬¬äºŒé¡µæµé‡é˜µåœ°çš„é€‰æ‹©
            if (userSelectedPlatforms.length === 0) {
                $('#generated_path').text('è¯·å…ˆé€‰æ‹©è°ƒç ”å¹³å°');
                console.log('æ²¡æœ‰é€‰æ‹©ä»»ä½•å¹³å°');
                return;
            }
            
            // æ ¹æ®ç”¨æˆ·é€‰æ‹©çš„é¡ºåºç”Ÿæˆè·¯å¾„
            let pathText = userSelectedPlatforms.join(' â†’ ');
            
            $('#generated_path').text(pathText);
            console.log('ä½¿ç”¨ç¬¬äºŒé¡µé€‰æ‹©ç”Ÿæˆè·¯å¾„ï¼š', pathText);
        }
        
              
        // é¡µé¢åŠ è½½æ—¶ç”Ÿæˆè·¯å¾„
        $(document).ready(function() {
            generateTrafficPathFromOrder();
        });
    </script>
</body>
</html>